@model MMS.Web.Models.AgentMasterModel.AgentMasterModel
@using MMS.Repository.Managers
@using MMS.Core.Entities
@{
    int id = Model.AgentMasterId;
    Session["AgentMasterId"] = id;
                                            //CommisionCritiriaManager manager = new CommisionCritiriaManager();
                                            //CommisionCriteria commisionCriteria = new CommisionCriteria();
                                            //commisionCriteria = manager.GetCommisionCriteriaId(Model.CommisionCriteriaId);
                                            //if (commisionCriteria != null)
                                            //{
                                            //    //Model.CommisionCritiriaName = commisionCriteria.CommisionName;
                                            //    //Model.CommisionPercentage = commisionCriteria.CommisionPercent;
                                            //}
}

<div class="right-form-section clearfix">
    <form class="form-inline" role="form">

        <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#step1">Agent Master</a></li>
        </ul>
        <div class="tab-content">
            <div id="step1" class="tab-pane fade in active">
                <div class="container-fluid">

                    <div class="row" style="margin-top: 20px;">
                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">

                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Agent Code</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.HiddenFor(x => x.AgentMasterId)
                                        @Html.TextBoxFor(m => m.AgentCode, new { @class = "form-control text-field", @readonly="true" })
                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Agent Full Name</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.TextBoxFor(m => m.AgentFullName, new { @class = "form-control text-field" })
                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Agent Short Name</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.TextBoxFor(m => m.AgentShortName, new { @class = "form-control text-field" })
                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Currency</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.DropDownListFor(m => m.Currency, MMS.Web.ExtensionMethod.HtmlHelper.CurrencyName(), new { @class = "select-style text-field" })
                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Address of Communication</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.TextAreaFor(m => m.AddressLine1, new { @class = "form-control text-field" })
                                    </div>
                                </div>
                            </div>


                        </div>
                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Pin Code</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.TextBoxFor(m => m.Pincode, new { @class = "form-control text-field" })
                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Contact Person</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.TextBoxFor(m => m.ContactPerson, new { @class = "form-control text-field" })
                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Contact No</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.TextBoxFor(m => m.MobileNo, new { @class = "form-control text-field", onkeypress = "return isNumberKey(event)" })
                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Email Id</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.TextBoxFor(m => m.EmailID, new { @class = "form-control text-field" })
                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Commission Critiria Name</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.CommisionCriteriaId, MMS.Web.ExtensionMethod.HtmlHelper.CommisionName(), new { @class = "select-style text-field" })
                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Commission %</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.TextBoxFor(m => m.CommisionPercentage, new { @class = "form-control text-field", onclick = "Numeric()" })
                                    </div>
                                </div>
                            </div>



                        </div>
                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 no-pad">
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12">
                                        <label for="text" class="form-label">Commision Critiria</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        <div class="table-responsive table-td-padding parent-table-height padding-lr-6px table-row-bg">
                                            <table class="table" id="list-components">
                                                <thead>
                                                    <tr>
                                                        <td>Comm. Name</td>
                                                        <td>Critiria</td>
                                                        <td>Value</td>
                                                        <td>Comm. Percentage</td>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @if (Model != null && Model.CommisionCriteriaList != null)
                                                    {
                                                        foreach (var item in Model.CommisionCriteriaList)
                                                        {
                                                        <tr>
                                                            <td>@item.CommisionName</td>
                                                            <td>@item.Criteria</td>
                                                            <td>@item.Value</td>
                                                            <td>@item.CommisionPercent</td>
                                                        </tr>
                                                        }
                                                    }
                                                </tbody>

                                            </table>
                                        </div>
                                        <!--  </div> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                </div>
            </div>


        </div>
        <div class="form-footer">
            <div class="row">
                <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 text-center">


                  
                    <input type="button" onclick="Cancel()" class="btn btn-default btn-style" title="Back" value="Back">
                    @if (Model != null && Model.AgentMasterId != 0)
                    {

                        <input type="button" onclick="Update()" class="btn btn-default btn-style" id="AgentMasterId" title="Update" value="Update">
                    }
                    else
                    {
                        <input type="button" onclick="Save()" class="btn btn-default btn-style" title="Save" value="Save">
                    }
                    <button type="submit" class="btn btn-default btn-style">Clear</button>


                </div>
            </div>
        </div>
    </form>
    <p class="bottom-para"><b>PS</b> : Import to be incorporated from customer given Excel sheet.</p>
</div>





<script>
    $(document).ajaxStart(function () {
        $(".loader-overlay").css("display", "block");
    });

    $(document).ajaxComplete(function () {
        $(".loader-overlay").css("display", "none");
    });
    $(window).load(function () {
        $('.loader-overlay').fadeOut('fast');
    });
    var specialKeys = new Array();
    specialKeys.push(8); //Backspace
    function Numeric() {

        $("#CommisionPercentage").bind("keypress", function (e) {
            var keyCode = e.which ? e.which : e.keyCode
            var ret = ((keyCode >= 48 && keyCode <= 57) || specialKeys.indexOf(keyCode) != -1);

            $(".error").css("Average", ret ? "none" : "inline");
            return ret;
        });
        $("#CommisionPercentage").bind("paste", function (e) {
            return false;
        });
        $("#CommisionPercentage").bind("drop", function (e) {
            return false;
        });
    }

    //$(function () {
    $("#CommisionCriteriaId").change(function () {
        $.ajax({
            type: 'POST',
            url: ' @Url.Action("InternalModelDetail", "AgentMaster")',
            data: { CommisionCriteriaId: $('#CommisionCriteriaId').val() },
            success: function (data) {
                $("#CommisionPercentage").val(data.CommissionPercent);
            },
        });

    });
    // });
</script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css"> 
@*<link href="~/Scripts/EasyAutocomplete-1.3.5/comboStyles.css" rel="stylesheet" />*@
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="~/Scripts/EasyAutocomplete-1.3.5/ComboBox.js"></script>
<script>
    $("#CommisionCriteriaId").combobox();
    $("#Currency").combobox();
</script>