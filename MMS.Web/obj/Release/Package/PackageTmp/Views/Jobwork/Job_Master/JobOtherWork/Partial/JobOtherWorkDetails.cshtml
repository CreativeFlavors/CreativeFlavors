@model MMS.Web.Models.JobOtherWork.JobOtherWorkModel
@using MMS.Repository.Managers.JobWork
@using MMS.Core.Entities.JobWork

@{
    <link href="~/Content/chosen/bootstrap-chosen.css" rel="stylesheet" />
    <script src="~/Scripts/chosen/chosen.jquery.js"></script>
}


<script>
    $(".chosen-select").chosen();
</script>


<div class="other_job_service1 home_dashboard col-xs-12 dashboard-content-pad dashboard-content-pad-scroll mCustomScrollbar light" data-mcs-theme="minimal-dark">
    <div class="input_grp_radio col-lg-12 col-md-12 col-sm-12">
        <div class="other_job_service dashboard-content radio-option col-lg-12 col-md-12 col-xs-12">
            <div class="col-lg-12 col-md-12 col-sm-12">
                <form action="#" class="row">
                    <div class="form-group dept-select col-md-5">
                        <label class="department">Department</label>
                        @Html.DropDownListFor(m => m.Department_Id, MMS.Web.ExtensionMethod.HtmlHelper.GateEntryEmpDept(), new { @class = "form-control input chosen-select" })                       
                    </div>
                    <div class="dashboard-content radio-option col-md-7 col-xs-12" style="padding-top:14px;">
                        <form action="#">   
                            @if (Model.Services == true)
                            {
                                <span>
                                    <input value="0" class="with-gap" name="group1" type="radio" id="OtherJob"  />
                                    <label for="OtherJob">Other Job Work</label>
                                </span>
                                <span>
                                    <input  value="1" class="with-gap" name="group1" type="radio" id="Services" checked="checked"/>
                                    <label for="Services">Services</label>
                                </span>
                            }
                            else
                            {
                                <span>
                                    <input value="0"  class="with-gap" name="group1" type="radio" id="OtherJob" checked="checked" />
                                    <label for="OtherJob">Other Job Work</label>
                                </span>
                                <span>
                                    <input value="1"  class="with-gap" name="group1" type="radio" id="Services" />
                                    <label for="Services">Services</label>
                                </span>
                            }

                        </form>
                    </div>

                </form>
            </div>
        </div>
    </div>
    <div class="header_list_tab  col-lg-12 col-md-12 col-sm-12  col-xs-12">
        <div class="col-lg-12 col-md-12 col-sm-12 col-12 no-padding">
            <div class="list_tab">
                <div class="title">
                    Detail
                </div>
            </div>
        </div>
        <div class="col-lg-6 col-md-12 col-sm-12  col-xs-12">
            <div class="button_tab  col-lg-12 col-md-12 col-sm-12 col-12 no-padding">

            </div>
        </div>
    </div>


    <div class="other_job_service1 mob_padding col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="col-xs-12 block-section ordr-sheet-blk">
            <div class="row">
                <div class="col-md-11">
                    <div class="col-md-12">
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="input-group date my_picker" data-date-format="MM/dd/yyyy">
                                <label>Date</label>
                                @Html.TextBoxFor(m => m.OtherJobWork_Date, new { @class = "form-control filter-cal" })
                                <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Jobwork No</label>
                                @Html.HiddenFor(m => m.OtherJobWork_Id)
                                @Html.TextBoxFor(m => m.OtherJobWork_Code, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Jobwork Name</label>
                                @Html.DropDownListFor(m => m.JobWork_Id, MMS.Web.ExtensionMethod.HtmlHelper.JobworkName(), new { @class = "form-control input chosen-select" })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Process/Service</label>
                                @Html.DropDownListFor(m => m.Process_Id, MMS.Web.ExtensionMethod.HtmlHelper.ProcessName(), new { @class = "form-control input chosen-select" })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Buyer</label>
                                @Html.DropDownListFor(m => m.Buyer_Id, MMS.Web.ExtensionMethod.HtmlHelper.BuyerName(), new { @class = "form-control input chosen-select" })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Season</label>
                                @Html.DropDownListFor(m => m.Season_Id, MMS.Web.ExtensionMethod.HtmlHelper.SeasonName(), new { @class = "form-control input chosen-select" })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Stores</label>
                                @Html.DropDownListFor(m => m.Stoeres_Id, MMS.Web.ExtensionMethod.HtmlHelper.Store(), new { @class = "form-control input chosen-select" })
                            </div>
                        </div>

                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Group</label>
                                @Html.DropDownListFor(m => m.Group_Id, MMS.Web.ExtensionMethod.HtmlHelper.MaterialGroupName(), new { @class = "form-control input chosen-select" })
                            </div>
                        </div>
                        <div class="col-lg-12 col-md-12 col-sm-12 input-blk">
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <label>Cateogory</label>
                                    @Html.DropDownListFor(m => m.Category_Id, MMS.Web.ExtensionMethod.HtmlHelper.MaterialCategoryName(), new { @class = "form-control input chosen-select" })
                                </div>
                                <div class="form-group services-dsc col-md-6" style="display:@(Model.Services==true?"block":"none")">
                                    <label>Service Description</label>
                                    @Html.TextBoxFor(m => m.ServiceDescription, new { @class = "form-control " })
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12 col-md-12 col-sm-12 input-blk mateial-select" style="display:@(Model.Services==false?"block":"none")">
                            <div class="form-group">
                                <label>Machinery Name</label>
                                @Html.DropDownListFor(m => m.Machinery_Id, MMS.Web.ExtensionMethod.HtmlHelper.MachineName(), new { @class = "form-control input chosen-select" })
                            </div>
                        </div>
                        <div class="col-lg-12 col-md-12 col-sm-12 input-blk mateial-select" style="display:@(Model.Services==false?"block":"none")">
                            <div class="form-group">
                                <label>Material Name</label>
                                @Html.DropDownListFor(x => x.Spare_Id, MMS.Web.ExtensionMethod.HtmlHelper.GEMaterialName(), new { @class = "form-control input chosen-select" })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Quantity</label>
                                @Html.TextBoxFor(m => m.Quantity, new { @class = "form-control " })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>UOM</label>
                                @*@Html.TextBoxFor(m => m.UOM, new { @class = "form-control " })*@
                                @Html.DropDownListFor(x => x.UOM, MMS.Web.ExtensionMethod.HtmlHelper.UomUnit(), new { @class = "form-control input chosen-select" })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Jobwork Price /UOM in Rs</label>
                                @Html.TextBoxFor(m => m.JobWork_Price, new { @class = "form-control ", @readonly = true })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Jobwork Price value</label>
                                @Html.TextBoxFor(m => m.JobWork_Price_Value, new { @class = "form-control ", @readonly = true })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>GST</label>
                                @Html.TextBoxFor(m => m.GST, new { @class = "form-control " })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>GST AMT</label>
                                @Html.TextBoxFor(m => m.GST_Amount, new { @class = "form-control ", @readonly = true })
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 input-blk">
                            <div class="form-group">
                                <label>Total Cost</label>
                                @Html.TextBoxFor(m => m.TotalCost, new { @class = "form-control ", @readonly = true })
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-1"> </div>

            </div>

        </div>

    </div>

    <div class="init_action sheet-pairs col-lg-12 col-md-12 col-sm-12">
        <div class="init_button">
            <button class="btn green-grey" onclick="Back()">Back</button>
            @if (Model != null && Model.OtherJobWork_Id != 0)
            {
                <button class="btn green-btn" onclick="Update()">Update</button>
            }
            else
            {
                <button class="btn green-btn " onclick="Save()">Save</button>
            }
            @*<button class="btn green-btn " onclick="Save()">Save</button>*@
        </div>
        <div class="checkbox-option sheet-pairs">
            <div class="form-group checkbox_tax">
                <input type="checkbox" id="tax">
                <label for="tax">SMS</label>
            </div>
            <div class="form-group checkbox_tax">
                <input type="checkbox" id="tax1">
                <label for="tax1">Email</label>
            </div>
        </div>

    </div>
</div>



<script src="~/Scripts/Jobwork/js/datepicker.min.js"></script>
<script src="~/Scripts/Jobwork/js/custom_script.js"></script>
<script src="~/Scripts/moment.js"></script>


<script>
    $("#JobWork_Id").change(function () {
        
        if ($('#Process_Id').val() != "" && $('#JobWork_Id').val() != "") {
            
            $.ajax({
                type: 'GET',
                url: '/JobOtherWork/GetJobPrice',
                data: { JobWork_Id: $('#JobWork_Id').val(), Process_Id: $('#Process_Id').val() },
                success: function (data) {
                    $('#JobWork_Price').val(data);
            },
            });
        }
    });

    $("#Process_Id").change(function () {        
        if ($('#Process_Id').val() != "" && $('#JobWork_Id').val() != "") {            
            $.ajax({
                type: 'GET',
                url: '/JobOtherWork/GetJobPrice',
                data: { JobWork_Id: $('#JobWork_Id').val(), Process_Id: $('#Process_Id').val() },
                success: function (data) {
                    $('#JobWork_Price').val(data);
                },
            });
        }
    });

    $("#Quantity").change(function () {
        var amt = ($('#Quantity').val() * $('#JobWork_Price').val());
        $('#JobWork_Price_Value').val(amt);
        if ($('#GST').val != "")
        {
            var gstamt = ($('#JobWork_Price_Value').val() * ($('#GST').val() / 100));
            $('#GST_Amount').val(gstamt);
            var amt = ($('#Quantity').val() * $('#JobWork_Price').val());
            $('#TotalCost').val(gstamt + amt);
        }
    });
    

    $("#GST").change(function () {
        var gstamt = ($('#JobWork_Price_Value').val() * ($('#GST').val()/100));
        $('#GST_Amount').val(gstamt);
        var amt = ($('#Quantity').val() * $('#JobWork_Price').val());
        $('#TotalCost').val(gstamt+amt);
    });

    $("input[type='radio'][name='group1']").change(function () {
        var value = $(this).val();
        if (value == 0)
        {
            $('.services-dsc').css('display', 'none');
            $('.mateial-select').css('display', 'block');
        }
        else {
            $('.services-dsc').css('display', 'block');
            $('.mateial-select').css('display', 'none');
        }
       
    });

</script>