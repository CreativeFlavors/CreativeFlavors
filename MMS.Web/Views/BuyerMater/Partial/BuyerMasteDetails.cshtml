@model MMS.Web.Models.BuyerMaserModel.BuyerMasterModel
@using MMS.Repository.Managers
@using MMS.Core.Entities
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="~/Content/css1/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/css1/custom.css" rel="stylesheet" />
    <link href="~/Content/css1/responsive.css" rel="stylesheet" />
    <link href="~/Content/css1/variables.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />
    <link href="~/Content/css1/Toast.css" rel="stylesheet" />

</head>

<body>



    <div class="main-page">
        <section class="inner-section">
            <div class="edit-customer">
                <a href="/BuyerMater/BuyerMater">
                    <div class="back-button"><img src="~/Content/assets/images/choose-plan.png" alt="back arrow"></div>
                </a>
                <h2 class=" font-20">Buyer info</h2>

            </div>


            <div class="edit-section">
                <h3 class="font-20">Basic Information</h3>
                <div class="row">
                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#CustomerName">BuyerName</label>
                            @Html.TextBoxFor(m => m.CustomerName, new { @class = "form-control text-field", placeholder = "Enter the Buyer Name", onkeyup = "buyernamefun()" })
                            @Html.HiddenFor(m => m.BuyerMasterId)
                            <p class="text-danger" id="CustomerNameResult"></p>
                        </div>
                    </div>

                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#BuyerCode">BuyerCode</label>
                            @Html.TextBoxFor(m => m.BuyerCode, new { @class = "form-control text-field", placeholder = "Enter the  BuyerCode ", onkeyup = "BuyerCodefun()" })
                            <p class="text-danger" id="BuyerCodeResult"></p>
                        </div>
                    </div>

                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#BuyerShortName">BuyerShortName</label>
                            @Html.TextBoxFor(m => m.BuyerShortName, new { @class = "form-control text-field", placeholder = "Enter the BuyerShortName", onkeyup = "BuyerShortNamefun()" })
                            <p class="text-danger" id="NameResult"></p>

                            <p id="NameResult"></p>
                        </div>
                    </div>

                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#EmailContact">Email </label>
                            @Html.TextBoxFor(m => m.EmailContact, new { @class = "form-control text-field", placeholder = "Enter the Email Contact", onkeyup = "EmailContactfun()" })
                            <p class="text-danger" id="EmailResult"></p>
                        </div>
                    </div>

                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#Account">Account No</label>
                            @Html.TextBoxFor(m => m.Account, new { @class = "form-control text-field", placeholder = "Enter the Account No", onkeyup = "Accountfun()" })
                            <p class="text-danger" id="AccountResult"></p>
                        </div>
                    </div>

                    <div class="col-lg-4 col-md-4 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#AccountName">Account Name</label>
                            @Html.TextBoxFor(m => m.AccountName, new { @class = "form-control text-field", placeholder = "Enter the Account Name", onkeyup = "AccountNamefun()" })
                            <p class="text-danger" id="AccountNameResult"></p>
                        </div>
                    </div>

                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#AccountDescription">Account Description</label>
                            @Html.TextBoxFor(m => m.AccountDescription, new { @class = "form-control text-field", placeholder = "Enter the Account Description", onkeyup = "AccountDescriptionfun()" })
                            <p class="text-danger" id="AccountDescriptionResult"></p>
                        </div>
                    </div>

                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#SwiftCode">Swift Code</label>
                            @Html.TextBoxFor(m => m.SwiftCode, new { @class = "form-control text-field", placeholder = "Enter the Swift Code", onkeyup = "SwiftCodefun()" })
                            <p class="text-danger" id="SwiftCodeResult"></p>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#Physical1">Address</label>
                            @Html.TextAreaFor(m => m.Physical1, new { @class = "form-control text-field", placeholder = "Enter the Address", onkeyup = "Physical1fun()" })
                            <p class="text-danger" id="Physical1Result"></p>
                        </div>
                    </div>




                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#PhysicalCode">Zip Code</label>
                            @Html.TextBoxFor(m => m.PhysicalCode, new { @class = " form-control text-field", placeholder = "Enter the Zip Code", onkeyup = "PhysicalCodefun()" })
                            <p class="text-danger" id="PhysicalCodeResult"></p>
                        </div>
                    </div>




                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#CurrencyId">Currency Type</label>
                            @Html.DropDownListFor(m => m.CurrencyId, MMS.Web.ExtensionMethod.HtmlHelper.CurrencyName(), new { @class = "select-style text-field", onchange = "CurrencyIdfun()" })
                            <p class="text-danger" id="CurrencyIdResult"></p>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#Telephone1">Telephone 1</label>
                            @Html.TextBoxFor(m => m.Telephone1, new { @class = "form-control text-field", placeholder = "Enter the Telephone 1", onkeyup = "Telephone1fun()" })
                            <p class="text-danger" id="Telephone1Result"></p>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#Telephone2">Telephone 2</label>
                            @Html.TextBoxFor(m => m.Telephone2, new { @class = "form-control text-field", placeholder = "Enter the Telephone 2", onkeyup = "Telephone2fun()" })
                            <p class="text-danger" id="Telephone2Result"></p>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#EmailAccounts">Email Account</label>
                            @Html.TextBoxFor(m => m.EmailAccounts, new { @class = "form-control text-field", placeholder = "Enter the Email Accounts", onkeyup = "EmailAccountsfun()" })
                            <p class="text-danger" id="EmailAccountsResult"></p>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#EmailEmergency">Email Emergency</label>
                            @Html.TextBoxFor(m => m.EmailEmergency, new { @class = "form-control text-field", placeholder = "Enter the Email Emergency", onkeyup = "EmailEmergencysfun()" })
                            <p class="text-danger" id="EmailEmergencyResult"></p>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#AccountTypeId">Account Type </label>
                            @Html.DropDownListFor(m => m.AccountTypeId, MMS.Web.ExtensionMethod.HtmlHelper.accountypeName(), new { @class = "select-style text-field", onchange = "AccountTypeIdfun()" })
                            <p class="text-danger" id="AccountTypeIdResult"></p>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#VatNumber">Vat Number</label>
                            @Html.TextBoxFor(m => m.VatNumber, new { @class = "form-control text-field", placeholder = "Enter the Vat Number", onkeyup = "VatNumberfun()" })
                            <p class="text-danger" id="VatNumberResult"></p>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#RegNumber">Reg Number</label>
                            @Html.TextBoxFor(m => m.RegNumber, new { @class = "form-control text-field", placeholder = "Enter the Reg Number", onkeyup = "RegNumberfun()" })
                            <p class="text-danger" id="RegNumberResult"></p>
                        </div>
                    </div>




                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#CreditLimit">Credit Limit</label>
                            @Html.TextBoxFor(m => m.CreditLimit, new { @class = "form-control text-field", placeholder = "Enter the Credit Limit", onkeyup = "CreditLimitResultfun()" })
                            <p class="text-danger" id="CreditLimitResult"></p>
                        </div>
                    </div>



                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#Interest">Interest</label>
                            @Html.TextBoxFor(m => m.Interest, new { @class = "form-control text-field", placeholder = "Enter the Interest", onkeyup = "InterestResultfun()" })
                            <p class="text-danger" id="InterestResult"></p>
                        </div>
                    </div>




                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#TaxTypeId">Tax Type </label>
                            @Html.DropDownListFor(m => m.TaxTypeId, MMS.Web.ExtensionMethod.HtmlHelper.GetTaxRef(), new { @class = "select-style text-field", onchange = "TaxTypeIdfun()" })
                            <p class="text-danger" id="TaxTypeIdResult"></p>
                        </div>

                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#ForeignCurrency">Foreign Currency </label>
                            @Html.DropDownListFor(m => m.ForeignCurrency, MMS.Web.ExtensionMethod.HtmlHelper.forCurrencyName(), new { @class = "select-style text-field", onchange = "ForeignCurrencyfun()" })
                            <p class="text-danger" id="ForeignCurrencyResult"></p>

                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#DcBalance">DcBalance</label>
                            @Html.TextBoxFor(m => m.DcBalance, new { @class = "form-control text-field", placeholder = "Enter the DcBalance", onkeyup = "DcBalancefun()" })
                            <p class="text-danger" id="DcBalanceResult"></p>
                        </div>
                    </div>

                    @*<div class="col-lg-4 col-md-6 col-sm-12">
                            <div class="input-part">
                                <label class="font-14" for="#ForeignDcBalance">ForeignDcBalance</label>
                                @Html.TextBoxFor(m => m.ForeignDcBalance, new { @class = "form-control text-field", placeholder = "Enter the ForeignDcBalance" })
                                <p class="text-danger" id="ForeignDcBalanceResult"></p>
                            </div>
                        </div>*@


                    <div class="col-lg-4 col-md-6 col-sm-12">
                        <div class="input-part">
                            <label class="font-14" for="#Website">Website</label>
                            @Html.TextBoxFor(m => m.Website, new { @class = "form-control text-field", placeholder = "Enter the Website", onkeyup = "WebsiteResultfun()" })
                            <p class="text-danger" id="WebsiteResult"></p>
                        </div>
                    </div>

                </div>

                <div class="row">

                </div>
                <div class="inner-section-button mt-4">

                    <button type="submit" id="savebutton" class="fill-color font-15" onclick="Save(); buyerformsave();">
                        SAVE
                    </button>

                    <a href="/BuyerMater/BuyerMater">
                        <button class="border-color font-15">
                            CANCEL
                        </button>
                    </a>
                </div>
            </div>

        </section>
    </div>
    <div id="toast"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
    <script src="~/content/js/custom.js"></script>
    <script src="~/content/js/bootstrap.bundle.min.js"></script>

    <script src="~/Content/js/Validation.js"></script>



    <script>
        $(window).on("load", function () {
            $(".report-inner-section").addClass("transection");
            $("#BuyerMater").attr('checked', true);
        });
    </script>

    <script>
        function Save() {
            var BuyerMasterId = $("#BuyerMasterId").val();
            var CustomerName = $("#CustomerName").val();
            var BuyerCode = $("#BuyerCode").val();
            var BuyerShortName = $("#BuyerShortName").val();
            var Account = $("#Account").val();
            var AccountName = $("#AccountName").val();
            var AccountDescription = $("#AccountDescription").val();
            var SwiftCode = $("#SwiftCode").val();
            var Physical1 = $("#Physical1").val();
            var PhysicalCode = $("#PhysicalCode").val();
            var CurrencyId = $("#CurrencyId").val();
            var Telephone1 = $("#Telephone1").val();
            var Telephone2 = $("#Telephone2").val();
            var EmailContact = $("#EmailContact").val();
            var EmailAccounts = $("#EmailAccounts").val();
            var EmailEmergency = $("#EmailEmergency").val();
            var AccountTypeId = $("#AccountTypeId").val();
            var VatNumber = $("#VatNumber").val();
            var RegNumber = $("#RegNumber").val();
            var CreditLimit = $("#CreditLimit").val();
            var ChargeInterest = $("#ChargeInterest").val();
            var Interest = $("#Interest").val();
            var DateAdded = $("#DateAdded").val();
            var TaxTypeId = $("#TaxTypeId").val();
            var ForeignCurrency = $("#ForeignCurrency").val();
            var DcBalance = $("#DcBalance").val();
            var ForeignDcBalance = $("#ForeignDcBalance").val();
            var Website = $("#Website").val();

            var formdata = new FormData();
            formdata.append("BuyerMasterId", BuyerMasterId);
            formdata.append("CustomerName", CustomerName);
            formdata.append("BuyerCode", BuyerCode);
            formdata.append("BuyerShortName", BuyerShortName);
            formdata.append("Account", Account);
            formdata.append("AccountName", AccountName);
            formdata.append("AccountDescription", AccountDescription);
            formdata.append("SwiftCode", SwiftCode);
            formdata.append("Physical1", Physical1);
            formdata.append("PhysicalCode", PhysicalCode);
            formdata.append("CurrencyId", CurrencyId);
            formdata.append("Telephone1", Telephone1);
            formdata.append("Telephone2", Telephone2);
            formdata.append("EmailContact", EmailContact);
            formdata.append("EmailAccounts", EmailAccounts);
            formdata.append("EmailEmergency", EmailEmergency);
            formdata.append("AccountTypeId", AccountTypeId);
            formdata.append("VatNumber", VatNumber);
            formdata.append("RegNumber", RegNumber);
            formdata.append("CreditLimit", CreditLimit);
            formdata.append("ChargeInterest", ChargeInterest);
            formdata.append("Interest", Interest);
            formdata.append("DateAdded", DateAdded);
            formdata.append("TaxTypeId", TaxTypeId);
            formdata.append("ForeignCurrency", ForeignCurrency);
            formdata.append("DcBalance", DcBalance);
            formdata.append("ForeignDcBalance", ForeignDcBalance);
            formdata.append("Website", Website);
            var email = /^(([^<>()[\]\\.,;:\s"]+(\.[^<>()[\]\\.,;:\s"]+)*)|.(".+"))((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            var filter = /^[0-9]+(\.[0-9]+)?$/;
            var phoneregx = /^[a-zA-Z\s\.]*$/;

            // Validation check
            if (CustomerName && BuyerCode && EmailContact && BuyerShortName && Physical1 && PhysicalCode &&
                Telephone1 && EmailEmergency && EmailAccounts && AccountTypeId && VatNumber && RegNumber &&
                CreditLimit && Interest && TaxTypeId && ForeignCurrency && DcBalance && Website && email.test(EmailContact) &&
                email.test(EmailAccounts) && email.test(EmailEmergency) && filter.test(DcBalance) && filter.test(Interest) & filter.test(CreditLimit) && phoneregx.test(CustomerName)) {

                // Choose the correct URL based on BuyerMasterId
                var url = BuyerMasterId === "0" ? '/BuyerMater/BuyerModel' : '/BuyerMater/Update';

                $.ajax({
                    type: 'POST',
                    url: url,
                    contentType: false,
                    processData: false,
                    dataType: 'json', // Expecting a JSON response
                    data: formdata,
                    success: function (data) {
                        if (data.AlertMessage == "Updated") {
                            sessionStorage.setItem("showToast", "updated");
                            window.location.href = "/BuyerMater/BuyerMater";
                        }
                        else if (data.AlertMessage === "saved") {
                            sessionStorage.setItem("showToast", "success");
                            window.location.href = "/BuyerMater/BuyerMater";
                        }
                        else if (data.AlertMessage === "already exist") {
                            showErrorToast();
                        }
                        else {
                            showsaveprocessToast();
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error('Error:', status, error);
                    }
                });
            }
        }

    </script>

</body>
</html>


















































































