@model MMS.Web.Models.StockModel.BillOfMaterialModel

@using MMS.Core.Entities.Stock
@using MMS.Repository.Managers.StockManager
@using MMS.Repository.Managers
@using MMS.Core.Entities
@using MMS.Web.Models.StockModel
@using System.Globalization;

@{
    var SnoVal = 1;
    ViewBag.Title = "BillOfMaterialDetails";
    List<BillOfMaterial>
    billOfMateriallist = new List<BillOfMaterial>
        ();
    BillOfMaterialManager billOfMaterialManager = new BillOfMaterialManager();
    billOfMateriallist = billOfMaterialManager.Get();
    Model.BillOfMaterialList = billOfMateriallist;
    MaterialManager materialManager = new MaterialManager();
    MaterialMaster materialMaster = new MaterialMaster();
    int comm;
    if (Model != null & Model.CommnBOM1 != "")
    {
        comm = Convert.ToInt32(Model.CommnBOM1);
    }

    MMS.Repository.Managers.ColorManager colorManager = new MMS.Repository.Managers.ColorManager();
    ColorMaster colorMaster = new ColorMaster();
    MMS.Repository.Managers.SubstanceMasterManager substanceMasterManager = new MMS.Repository.Managers.SubstanceMasterManager();
    SubstanceMaster substanceMaster = new SubstanceMaster();
    MMS.Repository.Managers.SupplierMasterManager supplierMasterManager = new MMS.Repository.Managers.SupplierMasterManager();
    SupplierMaster supplierMaster = new SupplierMaster();

    PermissionSettingMaster PermissionSettingModel = new MMS.Core.Entities.PermissionSettingMaster();
    PermissionSettingModel = MMS.Web.ExtensionMethod.HtmlHelper.GetPermissionIdList();

    List<PermissionMaster>
        PermissionModel = new List<PermissionMaster>
            ();
    PermissionModel = MMS.Web.ExtensionMethod.HtmlHelper.GetPermissionList("BillOfMaterial", PermissionSettingModel.PermissionID);
}
<style>
    [type="checkbox"]:not(:checked) + .lbl-ch::after, [type="checkbox"]:checked + .lbl-ch::after {
        content: '✔';
        position: absolute;
        top: -11px;
        left: 12px;
        font-size: 18px;
        line-height: 0.8;
        color: #06a8e8;
        transition: all .2s;
    }

    [type="checkbox"]:not(:checked) + .lbl-ch::before, [type="checkbox"]:checked + .lbl-ch::before {
        content: '';
        position: absolute;
        left: 10px;
        top: -15px;
        width: 20px;
        height: 20px;
        border: 1px solid #06a8e8;
        background: #f8f8f8;
        border-radius: 3px;
        -moz-border-radius: 3px;
        -webkit-border-radius: 3px;
    }

    .custom-combobox {
        width: 100%;
    }

    .but_search_styles {
        right: -24px !important;
    }
</style>

<script>
  
    // A $( document ).ready() block.
    $(document).ready(function () {
        //$("#MaterialName").combobox();   
        //$("#MaterialGroupMasterId").combobox();   
        //$("#MaterialCategoryMasterId").combobox();
        if(@Model.BomId==0)
        {
            $("#MeanSize").val(121);
            $("#NoOfSets").val("1");
        }
        $('#Addrowfields tbody').remove();
        $("#Date").datepicker({ dateFormat: "dd/mm/yy" });

        $("#Wastage").change(function () {

            var sn = $("#SampleNorms").val();
            var w = $(this).val();
            var wq = ((parseFloat(sn) / 100) * parseFloat(w));
            var tn = parseFloat(sn) + wq;
            $("#WastageQty").val(wq.toFixed(3));
            $("#TotalNorms").val(tn.toFixed(3));
        });

        $("#WastagePercent").keypress(function () {
            var sn = $(".SampleNorms").val();
            var w = $(this).val();
            var wq = parseFloat(sn) * parseFloat(w) / 100;
            var tn = parseFloat(sn) + parseFloat(wq);
            $(".WastageQty").val(wq.toFixed(3));
            $(".TotalNormsQty").val(tn.toFixed(3));
        });
    });

    function callChange(arg) {
        var id = '';
        var id1 = '';
        id = $('#Addrowfields tbody tr .WastagePercent' + arg).val();
        id1 = $('#Addrowfields tbody tr .SampleNorms' + arg).val();

        var wastage = parseFloat(id);
        var norms = parseFloat(id1);
        var wq = parseFloat(norms) * parseFloat(wastage) / 100;
        var tn = parseFloat(norms) + parseFloat(wq);
        $('#Addrowfields tbody tr .WastageQty' + arg).val(wq);
        $('#Addrowfields tbody tr .TotalNormsQty' + arg).val(tn);




    }

    var SnoVal = 1;

    $(function () {
        $("#ParentBomNo").change(function () {
            $.ajax({
                type: 'GET',
                // dataType: 'HTML',
                url: '/BillOfMaterial/ParentMaterialList',
                data: {
                    BomId: $(this).val()
                },
                success: function (data) {
                    // $('#MaterialListGrid').html("");
                    //$('#MaterialListGrid').html(data);
                    $("#BomNo").val(data.Model.BomNo);
                    $("#Description").val(data.Model.Description);
                    $("#BuyerMasterId").val(data.Model.BuyerMasterId);
                    $("#BuyerModel").val(data.Model.BuyerModel);
                    $("#MeanSize").val(data.Model.MeanSize);
                    $("#LinkBomNo").val(data.Model.LinkBomNo);
                    $("#BuyerNorms").val(data.Model.BuyerNorms);
                    $("#NoOfSets").val(data.Model.NoOfSets);
                    $("#UomMasterId").val(data.Model.UomMasterId);
                    $("#SupplierMasterId").val(data.Model.SupplierMasterId);
                    $("#SizeScheduleMasterId").val(data.Model.SizeScheduleMasterId);
                    $("#SizeRangeMasterId").val(data.Model.SizeRangeMasterId);

                    var rowCount = 0;
                    $.each(data.Material, function (index, item) {
                        $('#list-materials tbody').append("<tr onclick='RowClick('')'> <td style='display:none' class='BomNo'><span>" + item.BOMMaterialID + "</span><input type='hidden' class='BomId' value='" + item.BomId + "'></td>" +
                                                                                                                //"<td class='Description'><span>" + $('#Description').val() + "</span><input type='hidden' class='AddRowFields' value='" + $("#AddRowFields").val() + "'></td>" +
                                                                                                                "<td style='display:none' class='Description' id='Description'>" + item.Description + "</td>" +
                                                                                                                "<td style='display:none' class='BuyerMasterId' id='BuyerMasterId'>" + item.BuyerMasterId + "</td>" +
                                                                                                                "<td style='display:none' class='BuyerModel' id='BuyerModel'>" + item.BuyerModel + "</td>" +
                                                                                                                "<td style='display:none' class='MeanSize' id='MeanSize'>" + item.MeanSize + "</td>" +
                                                                                                                "<td style='display:none' class='Date' id='Date'>" + item.Date + "</td>" +
                                                                                                                "<td style='display:none' class='ParentBomNo' id='ParentBomNo'>" + item.ParentBomNo + "</td>" +
                                                                                                                "<td style='display:none' class='LinkBomNo' id='LinkBomNo'>" + item.LinkBomNo + "</td>" +
                                                                                                                "<td style='display:none' class='CommnBOM1' id='CommnBOM1'>" + item.CommnBOM1 + "</td>" +
                                                                                                                "<td style='display:none' class='CommnBOM1' id='CommnBOM1'>" + item.BOMMaterialID + "</td>" +
                                                                                                               " <td title='Delete' style='cursor:pointer;' class='Delete' id='Delete'><a href='data.Material.BOMMaterialID'>Delete</a></td>" +
                                                                                                                "<td><input type='button' value='Edit' onclick='RowClick(" + item.BOMMaterialID + "," + item.BomId + ")' class='' />" + "</td>" +
                                                                                                               // " <td title='Delete' style='cursor:pointer;' class='Delete' id='Delete'><a href='data.Material.BOMMaterialID'>Delete</a></td>" +
                                                                                                                "<td class='MaterialCategoryMasterId_' id='MaterialCategoryMasterId_'>" + item.CategoryName + "</td>" +
                                                                                                                "<td class='MaterialName_' id='MaterialName_'>" + item.MaterialName + "</td>" +
                                                                                                                "<td class='MaterialGroupMasterId_' id='MaterialGroupMasterId_'>" + item.GroupName + "</td>" +
                                                                                                                "<td class='ColorMasterId_' id='ColorMasterId_'>" + item.ColorName + "</td>" +
                                                                                                                "<td class='SubstanceMasterId_' id='SubstanceMasterId_'>" + item.SubtranceRangeName + "</td>" +
                                                                                                                // "<td style='display:none' class='SizeScheduleMasterId' id='SizeScheduleMasterId'>" + item.SizeScheduleMasterId + "</td>" +
                                                                                                                "<td class='SampleNorms' id='SampleNorms'>" + item.SampleNorms + "</td>" +
                                                                                                                //"<td class='Wastage' id='Wastage'>" + item.Wastage + "</td>" +
                                                                                                                //"<td class='WastageQty' id='WastageQty'>" + item.WastageQty + "</td>" +
                                                                                                                "<td class='WastageQtyUOM' id='WastageQtyUOM'>" + item.WastageQtyUOM + "</td>" +
                                                                                                                "<td class='TotalNorms' id='TotalNorms'>" + item.TotalNorms + "</td>" +
                                                                                                                //"<td class='TotalNormsUOM' id='TotalNormsUOM'>" + item.TotalNormsUOM + "</td>" +
                                                                                                                "<td style='display:none' class='ComponentName' id='ComponentName'>" + item.ComponentName + "</td>" +
                                                                                                                "<td style='display:none' class='BuyerNorms' id='BuyerNorms'>" + item.BuyerNorms + "</td>" +
                                                                                                                "<td style='display:none' class='NoOfSets' id='NoOfSets'>" + item.NoOfSets + "</td>" +
                                                                                                                "<td style='display:none' class='UomMasterId' id='UomMasterId'>" + item.UomMasterId + "</td>" +
                                                                                                                "<td style='display:none' class='SupplierMasterId' id='SupplierMasterId'>" + item.SupplierMasterId + "</td>" +
                                                                                                                "<td style='display:none' class='SizeRangeMasterId' id='SizeRangeMasterId'>" + item.SizeRangeMasterId + "</td>" +
                                       // "<td style='display:none' class='SizeScheduleMasterId' id='SizeScheduleMasterId'>" + data.BOM.SizeScheduleMasterId + "</td>" +
                                                                                                                "<td style='display:none' class='OurNorms' id='OurNorms'>" + item.OurNorms + "</td>" +
                                                                                                                "<td style='display:none' class='OurNormsPercent' id='OurNormsPercent'>" + item.OurNormsPercent + "</td>" +
                                                                                                                "<td style='display:none' class='PurchaseNorms' id='PurchaseNorms'>" + item.PurchaseNorms + "</td>" +
                                                                                                                "<td style='display:none' class='PurchaseNormsPercent' id='PurchaseNormsPercent'>" + item.PurchaseNormsPercent + "</td>" +
                                                                                                                "<td style='display:none' class='IssueNorms' id='IssueNorms'>" + item.IssueNorms + "</td>" +
                                                                                                                "<td style='display:none' class='IssueNormsPercent' id='IssueNormsPercent'>" + item.IssueNormsPercent + "</td>" +
                                                                                                                "<td style='display:none' class='CostingNorms' id='CostingNorms'>" + item.CostingNorms + "</td>" +
                                                                                                                 "<td style='display:none'class='MaterialCategoryMasterId' id='MaterialCategoryMasterId'>" + item.MaterialCategoryMasterId + "</td>" +
                                                                                                                "<td style='display:none' class='MaterialName' id='MaterialName'>" + item.MaterialName + "</td>" +
                                                                                                                "<td style='display:none' class='MaterialGroupMasterId' id='MaterialGroupMasterId'>" + item.MaterialGroupMasterId + "</td>" +
                                                                                                                "<td style='display:none' class='ColorMasterId' id='ColorMasterId'>" + item.ColorMasterId + "</td>" +
                                                                                                                "<td style='display:none' class='SubstanceMasterId' id='SubstanceMasterId'>" + item.SubstanceMasterId + "</td>" +
                                                                                                                "<td style='display:none' class='CostingNormsPercent' id='CostingNormsPercent'>" + item.CostingNormsPercent + "</td>" +
                                                                                                                "<td style='display:none' class='PreparedBy' id='PreparedBy'>" + item.PreparedBy + "</td>" +
                                                                                                                "<td style='display:none' class='VerifiedBy' id='VerifiedBy'>" + item.VerifiedBy + "</td>" +
                                                                                                                "<td style='display:none' class='CheckedBy' id='CheckedBy'>" + item.CheckedBy + "</td>"
                                                                                                                + "<td style='display:none' class='AddRowFields'>" + $('#AddRowFields').val() + "</td></tr>");
                        // $('#BOMMaterialID').val(data.Material.BOMMaterialID);
                        rowCount++;
                    });

                    // $("#NoOfSets").val(data.Model.NoOfSets);
                }
            });
        });
    });
    $(function () {
        $('#CommnBOM1,#CommnBOM2,#CommnBOM3,#CommnBOM4,#CommnBOM5').change(function () {
            $.ajax({
                type: 'GET',
                dataType: 'HTML',
                url: '/BillOfMaterial/ParentMaterialList',
                data: {
                    BomId: $(this).val()
                },
                success: function (data) {
                    $('#MaterialListGrid').html("");
                    $('#MaterialListGrid').html(data);
                }
            });
        });
    });
    $(document).on('click', '#add-Compenent', function () {
        // var data = $("#Addrowfields tbody tr").append;
        $("#Addrowfields tbody").append("<tr class=''><td id='Sno' value=''>" + SnoVal + "</td><td class='width-141'><input type='text' id='Component' value=''/></td><td class='width-91'><input type='text' id='length' class='length' value='' onkeypress=' return isNumberKey(event)' /></td><td class='width-91'><input type='text' id='width' class='width' value='' onkeypress='return isNumberKey(event)' /></td><td class='width-91'><input type='text' id='Nos' class='Nos' value='' onkeypress='return isNumberKey(event)' /></td><td class='width-91'><input type='text' id='SampleNorms' class='SampleNorms" + SnoVal + "' onkeypress='return isNumberKey(event)' /></td><td class='width-91'><input type='text' id='WastagePercent' class='WastagePercent" + SnoVal + "' onkeypress='return isNumberKey(event)' onchange='callChange(" + SnoVal + ")' /></td></td><td class='width-91'><input type='text' id='WastageQty' class='WastageQty" + SnoVal + "' onkeypress='return isNumberKey(event)' /></td><td class='width-91'><input type='text' id='TotalNormsQty' class='TotalNormsQty" + SnoVal + "' onkeypress='return isNumberKey(event)' /><td><input type='button' value='Remove' class='removeSchedule btn btn-default btn-style' /></td></tr>");
        SnoVal++;
    });
    $(document).on('click', '.removeSchedule', function () {
        $(this).closest("tr").remove();
    });

    function validation() {
        if ($('#BomNo').val() == "") {
            alert("Please Enter BomNo.")
            $('#BomNo').css('border-color', 'red');
            $('#BomNo').focus();
            return false;
        }
        else {
            $('#BomNo').css('border-color', '');
        }
        if ($('#Description').val() == "") {
            alert("Please Enter Description.")
            $('#Description').css('border-color', 'red');
            $('#Description').focus();
            return false;
        }
        else {
            $('#Description').css('border-color', '');
        }
        if ($('#BuyerMasterId').val() == "") {
            $('#BuyerMasterId').css('border-color', 'red');
            $('#BuyerMasterId').focus();
            alert("Please Select BuyerMasterId.")
            return false;
        }
        else {
            $('#BuyerMasterId').css('border-color', '');
        }

        if ($('#MeanSize').val() == "") {
            alert("Please Enter Last MeanSize.")
            $('#MeanSize').css('border-color', 'red');
            $('#MeanSize').focus();
            return false;
        }
        else {
            $('#MeanSize').css('border-color', '');
        }



        if ($('#Date').val() == "") {
            alert("Please Enter Date.")
            $('#Date').css('border-color', 'red');
            $('#Date').focus();
            return false;
        }
        else {
            $('#Date').css('border-color', '');
        }

        if ($('#MaterialCategoryMasterId').val() == "") {
            alert("Please select category.")
            $('#MaterialCategoryMasterId').css('border-color', 'red');
            $('#MaterialCategoryMasterId').focus();
            return false;
        }
        else {
            $('#MaterialCategoryMasterId').css('border-color', '');
        }
        //if ($('#MaterialName').val() == "") {
        //    alert("Please select material name.")
        //    $('#MaterialName').css('border-color', 'red');
        //    $('#MaterialName').focus();
        //    return false;
        //}
        //else {
        //    $('#MaterialName').css('border-color', '');
        //}
        if ($('#BuyerModel').val() == "") {
            alert("Please Select BuyerModel.")
            $('#BuyerModel').css('border-color', 'red');
            $('#BuyerModel').focus();
            return false;
        }
        else {
            $('#BuyerModel').css('border-color', '');
        }

        if ($('#MeanSize').val() == "") {
            alert("Please Enter Last MeanSize.")
            $('#MeanSize').css('border-color', 'red');
            $('#MeanSize').focus();
            return false;
        }
        else {
            $('#MeanSize').css('border-color', '');
        }


        if ($('#LinkBomNo').val() == "") {
            alert("Please Enter Order LinkBomNo.")
            $('#LinkBomNo').css('border-color', 'red');
            $('#LinkBomNo').focus();
            return false;
        }
        else {
            $('#LinkBomNo').css('border-color', '');
        }


        if ($('#MaterialCategoryMasterId').val() == "") {
            alert("Please Enter Category.")
            $('#MaterialCategoryMasterId').css('border-color', 'red');
            $('#MaterialCategoryMasterId').focus();
            return false;
        }
        else {
            $('#MaterialCategoryMasterId').css('border-color', '');
        }

        if ($('#MaterialGroupMasterId').val() == "") {
            alert("Please Enter Group.")
            $('#MaterialGroupMasterId').css('border-color', 'red');
            $('#MaterialGroupMasterId').focus();
            return false;
        }
        else {
            $('#MaterialGroupMasterId').css('border-color', '');
        }

        //if ($('#MaterialName').val() == "") {
        //    alert("Please Enter Material.")
        //    $('#MaterialName').css('border-color', 'red');
        //    $('#MaterialName').focus();
        //    return false;
        //}
        //else {
        //    $('#MaterialName').css('border-color', '');
        //}

        if ($('#ColorMasterId').val() == "") {
            alert("Please Enter Color.")
            $('#ColorMasterId').css('border-color', 'red');
            $('#ColorMasterId').focus();
            return false;
        }
        else {
            $('#ColorMasterId').css('border-color', '');
        }
        if($('#SubstanceMasterId').prop('disabled')==false)
        {
            if ($('#SubstanceMasterId').val() == "") {
                alert("Please Enter Substance.")
                $('#SubstanceMasterId').css('border-color', 'red');
                $('#SubstanceMasterId').focus();
                return false;
            }
            else {
                $('#SubstanceMasterId').css('border-color', '');
            }
        }

        //if ($('#SampleNorms').val() == "") {
        //    $('#SampleNorms').css('border-color', 'red');
        //    $('#SampleNorms').focus();
        //    alert("Please Enter SampleNorms.")
        //    return false;
        //}
        //else {
        //    $('#SampleNorms').css('border-color', '');
        //}


        //if ($('#Wastage').val() == "") {
        //    alert("Please Enter Wastage %.")
        //    $('#Wastage').css('border-color', 'red');
        //    $('#Wastage').focus();
        //    return false;
        //}
        //else {
        //    $('#Wastage').css('border-color', '');
        //}
        //if ($('#WastageQty').val() == "") {
        //    alert("Please Enter WastageQty.")
        //    $('#WastageQty').css('border-color', 'red');
        //    $('#WastageQty').focus();
        //    return false;
        //}
        //else {
        //    $('#WastageQty').css('border-color', '');
        //}

        if ($('#TotalNorms').val() == "") {
            alert("Please Enter TotalNorms.")
            $('#TotalNorms').css('border-color', 'red');
            $('#TotalNorms').focus();
            return false;
        }
        else {
            $('#TotalNorms').css('border-color', '');
        }
        if ($('#WastageQtyUOM').val() == "") {
            //alert("Please Enter Wastage UOM ")
            $('#WastageQtyUOM').css('border-color', 'red');
            $('#WastageQtyUOM').focus();
            return false;
        }
        else {
            $('#WastageQtyUOM').css('border-color', '');
        }

        //if ($('#TotalNormsUOM').val() == "") {
        //    //alert("Please Enter TotalNormsUOM.")
        //    $('#TotalNormsUOM').css('border-color', 'red');
        //    $('#TotalNormsUOM').focus();
        //    return false;
        //}
        //else {
        //    $('#TotalNormsUOM').css('border-color', '');
        //}

        if ($('#NoOfSets').val() == "") {
            alert("Please Enter NoOfSets.")
            $('#NoOfSets').css('border-color', 'red');
            $('#NoOfSets').focus();
            return false;
        }
        else {
            $('#NoOfSets').css('border-color', '');
        }
        if ($("#SizeRangeMasterId").prop('disabled') == false) {
            if ($('#SizeRangeMasterId').val() == "") {
                alert("Please Enter SizeRange")
                $('#SizeRangeMasterId').css('border-color', 'red');
                $('#SizeRangeMasterId').focus();
                return false;
            }
            else {
                $('#SizeRangeMasterId').css('border-color', '');
            }
        }
        else {
            $('#SizeRangeMasterId').val('');
        }


        if ($('#UomMasterId').val() == "") {
            $('#UomMasterId').css('border-color', 'red');
            $('#UomMasterId').focus();
            alert("Please Enter Uom.")
            return false;
        }
        else {
            $('#UomMasterId').css('border-color', '');
        }



    }

    function Save() {
        var systemUserValue = '';
        var Sno = '';
        var compnt = '';
        var _length = '';
        var width = '';
        var nos = '';
        var samplenms = '';
        var wstg = '';
        var wstqty = '';
        var wsttotalNorms = '';
        $('#Addrowfields tbody tr').each(function () {
            Sno = '';
            compnt = '';
            _length = '';
            width = '';
            nos = '';
            samplenms = '';
            wstg = '';
            wstqty = '';
            wsttotalNorms = '';
            $(this).find("td").each(function () {
                Sno = $('#Sno').val();
                if (Sno != undefined && Sno.trim().length > 0) {
                    systemUserValue += Sno + ',';
                }
                compnt = $(this).find('#Component').val();
                if (compnt != undefined && compnt.trim().length > 0) {
                    systemUserValue += compnt + ',';
                }
                _length = $(this).find('#length').val();
                if (_length != undefined && _length.trim().length > 0) {
                    systemUserValue += _length + ',';
                }
                width = $(this).find('#width').val();
                if (width != undefined && width.trim().length > 0) {
                    systemUserValue += width + ',';

                }
                nos = $(this).find('#Nos').val();
                if (nos != undefined && nos.trim().length > 0) {
                    systemUserValue += nos + ',';
                }

                samplenms = $(this).find('#SampleNorms').val();
                if (samplenms != undefined && samplenms.trim().length > 0) {
                    systemUserValue += samplenms + ',';
                }
                wstg = $(this).find('#WastagePercent').val();
                if (wstg != undefined && wstg.trim().length > 0) {
                    systemUserValue += wstg + ',';
                }
                wstqty = $(this).find('#WastageQty').val();
                if (wstqty != undefined && wstqty.trim().length > 0) {
                    systemUserValue += wstqty + ',';
                }
                wsttotalNorms = $(this).find('#TotalNormsQty').val();
                if (wsttotalNorms != undefined && wsttotalNorms.trim().length > 0) {
                    systemUserValue += wsttotalNorms;
                }

            });
            systemUserValue += '#';

        });
        var form = systemUserValue;
        console.log($('.AddRowFields').val());
        $('#AddRowFields').val(form);
        var CommnBOM = "";
        if ($('#CommnBOM1').val() != "") {
            CommnBOM = $('#CommnBOM1').val();
        }
        if ($('#CommnBOM2').val() != "") {
            CommnBOM += "," + $('#CommnBOM2').val();
        }
        if ($('#CommnBOM3').val() != "") {
            CommnBOM += "," + $('#CommnBOM3').val();
        }
        if ($('#CommnBOM4').val() != "") {
            CommnBOM += "," + $('#CommnBOM4').val();
        }
        if ($('#CommnBOM5').val() != "") {
            CommnBOM += "," + $('#CommnBOM5').val();
        }
        var rowCount = $('#list-materials tr').length - 1;
        if (rowCount == 0) {

            if (validation()) {


                var forms_ = $(".form-inline").serialize();

                if ($("#list-materials tbody tr").length == 0) {

                    $.ajax({
                        type: 'POST',
                        url: '/BillOfMaterial/BillOfMaterialDetails',
                        data: { forms: forms_, Grid: $('.AddRowFields').text(), BomGridlst: '@Model.BomGridlst' },
                        success: function (data) {
                            if (data == true) {
                                if ($("#BtnSave").val() == "Save") {
                                    alert('Saved Successfully.');
                                }
                                else {
                                    alert('Updated Successfully.');
                                }
                                //  $("#BtnSave").attr('value', 'Save');
                                location.href = "/BillOfMaterial/BOMMaterialListGrid";
                                return false;
                            }
                            else {
                                alert('Save process Failed.');
                                location.href = "/BillOfMaterial/BOMMaterialListGrid";
                                return false;
                            }
                        }
                    });

                }
            }
        }
        else {

            var wholeJsonList = [];
            console.log(forms_);
            console.log($('#AddRowFields').val());
            console.log($('#AddRowFields').val(form))
            $('#list-materials tbody tr').each(function () {
                $(this).addClass("curChangeableRow"),
               $(this).siblings().removeClass("curChangeableRow"),
              $('.curChangeableRow').hide(),

    wholeJsonList.push(
        {

            forms: forms_,
            Grid: $('.AddRowFields').text(),
            BomGridlst: '@Model.BomGridlst',
            BomNo: $(this).find('span').html(),
            Description: $(this).find('.Description').html(),
            BuyerMasterId: $(this).find('.BuyerMasterId').html(),
            BuyerModel: $(this).find('.BuyerModel').html(),
            MeanSize: $(this).find('.MeanSize').html(),
            Date: $(this).find('.Date').html(),
            ParentBomNo: $(this).find('.ParentBomNo').html(),
            LinkBomNo: $(this).find('.LinkBomNo').html(),
            CommnBOM1: $(this).find('.CommnBOM1').html(),
            MaterialCategoryMasterId: $(this).find('.MaterialCategoryMasterId').html(),
            MaterialName: $(this).find('.MaterialName').html(),
            MaterialGroupMasterId: $(this).find('.MaterialGroupMasterId').html(),
            ColorMasterId: $(this).find('.ColorMasterId').html(),
            SubstanceMasterId: $(this).find('.SubstanceMasterId').html(),
            SampleNorms: $(this).find('.SampleNorms').html(),
            Wastage: $(this).find('.Wastage').html(),
            WastageQty: $(this).find('.WastageQty').html(),
            WastageQtyUOM: $(this).find('.WastageQtyUOM').html(),
            TotalNorms: $(this).find('.TotalNorms').html(),
            TotalNormsUOM: $(this).find('.TotalNormsUOM').html(),
            ComponentName: $(this).find('.ComponentName').html(),
            BuyerNorms: $(this).find('.BuyerNorms').html(),
            NoOfSets: $(this).find('.NoOfSets').html(),
            UomMasterId: $(this).find('.UomMasterId').html(),
            SupplierMasterId: $(this).find('.SupplierMasterId').html(),
            SizeRangeMasterId: $(this).find('.SizeRangeMasterId').html(),
            SizeScheduleMasterId: $(this).find('.SizeScheduleMasterId').html(),
            OurNorms: $(this).find('.OurNorms').html(),
            OurNormsPercent: $(this).find('.OurNormsPercent').html(),
            PurchaseNorms: $(this).find('.PurchaseNorms').html(),
            PurchaseNormsPercent: $(this).find('.PurchaseNormsPercent').html(),
            IssueNorms: $(this).find('.IssueNorms').html(),
            IssueNormsPercent: $(this).find('.IssueNormsPercent').html(),
            CostingNorms: $(this).find('.CostingNorms').html(),
            CostingNormsPercent: $(this).find('.CostingNormsPercent').html(),
            PreparedBy: $(this).find('.PreparedBy').html(),
            VerifiedBy: $(this).find('.VerifiedBy').html(),
            CheckedBy: $(this).find('.CheckedBy').html(),

            // MultipleSchedule: JSON.stringify(scheduleArr),
            ////SizeQuantityRate: JSON.stringify(qtyArr),
            //PackingDetail: JSON.stringify(packingDetailsArr),
        });
            });

            var wholeJsonListLength = wholeJsonList.length;

            var i = 0;
            for (i = 0; i <= wholeJsonListLength - 1; i++) {
                $.ajax({
                    type: 'POST',
                    url: '/BillOfMaterial/BillOfMaterialDetails',
                    // url: '/BuyerOrderEntryForm/BuyerOrderEntryForm',
                    data: wholeJsonList[i],
                    success: function (data) {
                        if (data == true) {
                            if ($("#BtnSave").val() == "Save") {
                                alert('Saved Successfully.');
                            }
                            else {
                                alert('Updated Successfully.');
                            }
                            //  $("#BtnSave").attr('value', 'Save');
                            location.href = "/BillOfMaterial/BOMMaterialListGrid";
                            return false;
                        }
                        else {
                            alert('Save process Failed.');
                            location.href = "/BillOfMaterial/BOMMaterialListGrid";
                            return false;
                        }
                    }
                });
            }
        }

    }


    //  $(document).ready(function() {
    function DisplaySizeRange(){
        if($("#Displaycheck").is(":checked")==true && $('#SizeRangeMasterId').val()!=0) {
            $.ajax({
                type: "GET",
                dataType: "JSON",
                url: '@Url.Action("GetSizeRange", "BuyerOrderEntryForm")',
                data: { SizeRangeMasterId: $('#SizeRangeMasterId').val() },
                success: function (data) {
                    var count = 1;
                    for (var i = 0; i <= data.length; i++) {

                        $('#sizeRangeTable tbody tr:first-child').append('<td  style="background-color: #ddd;padding-bottom: 3px;width: auto !important;padding:0 0px;" class="SizeRangeRefValue"> ' + data[i].SizeRangeRefValue + ' </td> ');
                        $('#sizeRangeTable tbody tr:last').append("<td><input type='checkbox' name='size_chk' id='size_chk"+i+"' class='checked_checkbox'  style=''></input> <label for='size_chk"+i+"' style='' class='lbl-ch'></label></td>");
                        count++;
                    }
                }
            });
        }
        else
        {
            $('#sizeRangeTable tbody tr').each(function(){
                $(this).find("td:not(:first)").remove();

            });
        }
        // });
    }


</script>




<link href="~/Content/css/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/css/FormStyle.css" rel="stylesheet" />
<link rel="stylesheet" href="css/responsive.css">

<!-- custom scrollbar stylesheet -->
<link rel="stylesheet" href="css/jquery.mCustomScrollbar.css">

<!--   <script src="js/bootstrap.min.js"></script>
<script src="js/jquery-1.12.1.min.js"></script>   -->
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<link href="~/Scripts/EasyAutocomplete-1.3.5/comboStyles.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="~/Scripts/EasyAutocomplete-1.3.5/ComboBox.js"></script>
<script src="~/Scripts/EasyAutocomplete-1.3.5/AutoComplete%20v1.10.2.js"></script>
<script src="~/Scripts/EasyAutocomplete-1.3.5/AutoComplete%20v1.11.4.js"></script>
<script src="~/Scripts/AutoCompleteCommon.js"></script>
<script src="~/jquery-ui-timepicker-0.3.3/jquery.ui.timepicker.js"></script>
<link href="~/jquery-ui-timepicker-0.3.3/jquery.ui.timepicker.css" rel="stylesheet" />
<link type="text/css" href="~/Datepicker/css/ui-lightness/jquery-ui-1.8.19.custom.css" rel="stylesheet" />
<script src="~/jquery-ui-timepicker-0.3.3/jquery.ui.timepicker.js"></script>
<link href="~/jquery-ui-timepicker-0.3.3/jquery.ui.timepicker.css" rel="stylesheet" />
@*<script type="text/javascript" src="~/Datepicker/js/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="~/Datepicker/js/jquery-ui-1.8.19.custom.min.js"></script>*@
@*<script src="~/Scripts/tableHeadFixer.js"></script>
    <script src="~/Scripts/erpscripts.js"></script>*@
<style>
    .right-form-section {
        width: 98% !important;
    }

    #TotalDiv > div {
        margin-left: 30px;
    }
</style>

<div class="right-form-section clearfix" id="TotalDiv">
    <div>
        <input type="button" onclick="Cancel()" class="close_btn" title="Back" value="x">
    </div>
    <form class="form-inline" role="form">
        <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#step1">step 1</a></li>
            <li><a data-toggle="tab" href="#step2">Step 2</a></li>
        </ul>
        <div class="tab-content">
            <div id="step1" class="tab-pane fade in active">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 pull-right no-padding">
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12 ">
                                        <label for="text" class="form-label"><span class="orange-lable">Amendment</span></label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.HiddenFor(m => m.BomId)
                                        @Html.TextBoxFor(m => m.Ammendment, new { @class = "form-control text-field", placeholder = "enter text" })

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">

                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">
                                            BOM No :<br />
                                            (Sketch No )
                                        </label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.TextBoxFor(m => m.BomNo, new { @class = "form-control text-field", @style = "  width: 164px;", placeholder = "Enter Text" })

                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Description</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.TextBoxFor(m => m.Description, new { @class = "form-control text-field", @style = "  width: 164px;", placeholder = "Enter Text" })

                                    </div>
                                </div>
                            </div>

                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">
                                            Product Group<br />
                                            (Buyer Name)
                                        </label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.BuyerMasterId, MMS.Web.ExtensionMethod.HtmlHelper.BuyerName(), new { @class = "select-style text-field " })

                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Buyer Model</label>
                                    </div>

                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.BuyerModel, MMS.Web.ExtensionMethod.HtmlHelper.BuyerModel(), new { @class = "select-style text-field " })

                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Mean Size</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.MeanSize, MMS.Web.ExtensionMethod.HtmlHelper.SizeRangeValue(), new { @class = "select-style text-field " })



                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Date</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @if (Model != null && Model.BomId != 0)
                                        {
                                            var from = Model.Date;
                                            @Html.TextBoxFor(m => m.Date, new { @Value = from, @class = "form-control text-field" })
                                        }
                                        else
                                        {
                                            // var from = DateTime.Now.ToString();
                                            @Html.TextBoxFor(m => m.Date, new { @Value = System.DateTime.Now.Date.ToString("dd/MM/yyyy"), @class = "form-control text-field" })
                                        }

                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Parent BOM No.</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.ParentBomNo, MMS.Web.ExtensionMethod.HtmlHelper.GetBomNo(), new { @class = "select-style text-field " })

                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Last BOM No. Entered</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.TextBoxFor(m => m.LastBomNoEntered, new { @class = "form-control text-field", @readonly = "true" })

                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">
                                            Link BOM to this Style/  Product
                                        </label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @*@Html.DropDownListFor(m => m.LinkBomNo, new SelectList(
                                            new List<Object>
                                                {
                                                new { value = 0 , text = "Please Select"  },
                                                new { value = 1 , text = "1"  },
                                                new { value = 2 , text = "2" },
                                                new { value = 3 , text = "3" }

                                                },
                                                "value",
                                                "text",
                                                0), new { @class = "select-style text-field " })*@

                                        @Html.DropDownListFor(m => m.LinkBomNo, Model.bomStyleList, "Please Select", new { @class = "select-style text-field " })
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Common BOM No.</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">

                                        @Html.DropDownListFor(m => m.CommnBOM1, MMS.Web.ExtensionMethod.HtmlHelper.GetBomNo(), new { @class = "select-style text-field" })

                                    </div>
                                </div>
                            </div>

                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.CommnBOM2, MMS.Web.ExtensionMethod.HtmlHelper.Bom(), new { @class = "select-style text-field" })

                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.CommnBOM3, MMS.Web.ExtensionMethod.HtmlHelper.Bom(), new { @class = "select-style text-field" })

                                    </div>
                                </div>
                            </div>

                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.CommnBOM4, MMS.Web.ExtensionMethod.HtmlHelper.Bom(), new { @class = "select-style text-field" })

                                    </div>
                                </div>
                            </div>
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">

                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.CommnBOM5, MMS.Web.ExtensionMethod.HtmlHelper.Bom(), new { @class = "select-style text-field" })

                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                    <hr style="border-bottom: 1px solid #3498db;" />
                    <div class="row">
                        <p class="section-title">Material details</p>
                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">

                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label">Material Catogory</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12" id="materialCategory">
                                        @Html.DropDownListFor(m => m.MaterialCategoryMasterId, MMS.Web.ExtensionMethod.HtmlHelper.MaterialCategoryName(), new { @class = "select-style text-field" })

                                    </div>
                                </div>
                            </div>
                         
                        </div>

                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                            <div class="field-section">
                                <div class="form-group">
                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label" style="padding-left:15px;">Material  Group</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12" id="materialGroupID_">
                                        @Html.DropDownListFor(m => m.MaterialGroupMasterId, MMS.Web.ExtensionMethod.HtmlHelper.MaterialGroupName(), new { @class = "select-style text-field " })

                                    </div>
                                </div>

                            </div>
                            
                        </div>

                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label" style="padding-left:15px;">Substance</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.SubstanceMasterId, MMS.Web.ExtensionMethod.HtmlHelper.SubstanceRange(), new { @class = "select-style text-field " })

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-4 col-lg-8 col-xs-12 no-padding">
                            <div class="field-section">
                                <div class="form-group">
                                    @Html.HiddenFor(m => m.AddRowFields)
                                    @Html.HiddenFor(m => m.BOMMaterialID)
                                    <div class="col-md-5 col-sm-5 col-lg-3 col-xs-12">
                                        <label for="text" class="form-label">Material Name</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-9 col-xs-12 no-padding" id="masterialName_" style="padding-left: 0;left: -17px;">
                                        @Html.DropDownListFor(m => m.MaterialName, MMS.Web.ExtensionMethod.HtmlHelper.MaterialMasterName(), new { @class = "select-style text-field " })
                                        <button type="button" class="btn btn-info btn-sm but_search_styles" data-toggle="modal" title="Material List" data-target="#auto_search">...</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                            <div class="field-section">
                                <div class="form-group">

                                    <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                        <label for="text" class="form-label" style="padding-left:15px;">Color</label>
                                    </div>
                                    <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                        @Html.DropDownListFor(m => m.ColorMasterId, MMS.Web.ExtensionMethod.HtmlHelper.ColourName(), new { @class = "select-style text-field " })

                                    </div>
                                </div>
                            </div>
                            </div>



                        </div>
                    <div class="row">
                        <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 no-padding" style="padding: 10px 0px;">
                            <div class="col-md-3 col-lg-2 col-sm-3 col-xs-12 pad_left">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-xs-12">
                                            <label for="text" class="form-label">M² Conversion</label>
                                        </div>
                                        <div class="col-xs-12">
                                            <div class="col-xs-12 pull-left no-padding">
                                                 @Html.TextBoxFor(m => m.Conversion, new { @class = "form-control text-field ", @onkeypress = "return isNumberKey(event)", placeholder = "enter value" })
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-lg-2 col-sm-3 col-xs-12 pad">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12">
                                            <label style="height: auto;" for="text" class="form-label">TotalNorms</label>
                                        </div>
                                        <div class="col-md-12 col-sm-7 col-lg-12 col-xs-12">
                                            @*@Html.TextBoxFor(m => m.Wastage, new { @class = "form-control text-field ", placeholder = "enter value" })*@
                                            @Html.TextBoxFor(m => m.TotalNorms, new { @class = "form-control text-field ", @onkeypress = "return isNumberKey(event)", placeholder = "enter value" })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-lg-2 col-sm-3 col-xs-12">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12">
                                            <label style="height: auto;" for="text" class="form-label">Buyer Norms</label>
                                        </div>
                                     
                                            <div class="col-xs-12 pull-left">
                                                @*@Html.TextBoxFor(m => m.WastageQty, new { @class = "form-control text-field ", @onkeypress = "return isNumberKey(event)", placeholder = "enter value" })*@
                                                @Html.TextBoxFor(m => m.BuyerNorms, new { @class = "form-control text-field ", @onkeypress = "return isNumberKey(event)" })
                                            </div>
                                     
                                        
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-lg-2 col-sm-3 col-xs-12">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 no-padding">
                                            <label style="height: auto;" for="text" class="form-label">UOM</label>
                                        </div>
                                        
                                            
                                            <div class="col-xs-12  pull-right no-padding">
                                                @Html.DropDownListFor(m => m.WastageQtyUOM, MMS.Web.ExtensionMethod.HtmlHelper.Uom(), new { @class = "select-style text-field " })

                                            </div>
                                       
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 col-lg-2 col-sm-3 col-xs-12">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-xs-12">
                                            <label for="text" class="form-label">No of SET’s</label>
                                        </div>
                                        <div class="col-xs-12">
                                            <div class="col-xs-12 pull-left no-padding">
                                                @if (Model != null && Model.BomId != 0)
                                                {
                                                    @Html.TextBoxFor(m => m.NoOfSets, new { @class = "form-control text-field", @onkeypress = "return isNumberKey(event)" })
                                                }
                                                else
                                                {
                                                    @Html.TextBoxFor(m => m.NoOfSets, new { @class = "form-control text-field", @Value = "1", @onkeypress = "return isNumberKey(event)" })
                                                }

                                            </div>
                                        </div>
                                    </div>
                                </div>                                      
                            </div>
                            <div class="col-md-3 col-lg-2 col-sm-3 col-xs-12">
                                <div class="field-section">
                                    <div class="form-group">
                                       
                                        <div class="col-xs-12">
                                            <label for="text" class="form-label">Sample Norms</label>
                                        </div>
                                        <div class="col-xs-12">
                                            <div class="col-xs-12 pull-left no-padding">
                                                 @Html.TextBoxFor(m => m.SampleNorms, new { @class = "form-control text-field ", @onkeypress = "return isNumberKey(event)", placeholder = "enter value" })
                                            </div>
                                        </div>
                                    </div>
                                </div> 
                            </div>

                                @*<div class="col-md-3 col-lg-2 col-sm-3 col-xs-12 pad_right">
                <div class="field-section">
                    <div class="form-group">

                        <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12">
                            <label style="height: auto;" for="text" class="form-label">Total Norms</label>
                        </div>
                        <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12">
                            <div class="col-xs-12 pull-left no-padding">
                                @Html.TextBoxFor(m => m.TotalNorms, new { @class = "form-control text-field ", @onkeypress = "return isNumberKey(event)", placeholder = "enter value" })

                            </div>
                            <div class="col-md-6 col-sm-6 col-lg-6 col-xs-12  pull-right no-padding">
                                @Html.DropDownListFor(m => m.WastageQtyUOM, MMS.Web.ExtensionMethod.HtmlHelper.Uom(), new { @class = "select-style text-field " })

                            </div>
                        </div>
                    </div>
                </div>
            </div>*@
                                @*<div class="col-md-3 col-lg-2 col-sm-3 col-xs-12 pad_right">
                <div class="field-section">
                    <div class="form-group">

                        <div class="col-xs-12">
                            <label for="text" class="form-label">Buyer Norms</label>
                        </div>
                        <div class="col-xs-12">
                            @Html.TextBoxFor(m => m.BuyerNorms, new { @class = "form-control text-field ", @onkeypress = "return isNumberKey(event)" })
                        </div>
                    </div>
                </div>
            </div>*@

                            </div>
                        <div class="row">

                            @*<div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">*@

                            @*<div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                            <label for="text" class="form-label"></label>
                                        </div>
                                        <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                            @Html.DropDownListFor(m => m.ComponentName, MMS.Web.ExtensionMethod.HtmlHelper.ComponentMaster(), new { @class = "select-style text-field " })

                                        </div>
                                    </div>
                                </div>*@

                            @*</div>*@
                            @*<div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                                

                            </div>*@
                            <hr style="border-bottom: 1px solid #3498db;" />
                            <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                            <label for="text" class="form-label">Mat. Supply By</label>
                                        </div>
                                        <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                            @Html.DropDownListFor(m => m.SupplierMasterId, new SelectList(
                                                            new List<Object>
                                                                {
                                                                new { value = 0 , text = "Please Select"  },
                                                                new { value = 1 , text = "Buyer"  },
                                                                new { value = 2 , text = "Enco" }

                                                                },
                                                                "value",
                                                                "text",
                                                                0), new { @class = "select-style text-field " })

                                        </div>
                                    </div>
                                </div>
                               
                               
                            </div>
                            <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                            <label for="text" class="form-label">Size Match</label>
                                        </div>
                                        <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                            @Html.DropDownListFor(m => m.SizeScheduleMasterId, MMS.Web.ExtensionMethod.HtmlHelper.SizeScheduleMaster(), new { @class = "select-style text-field " })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                            <label for="text" class="form-label">Size Schedule</label>
                                        </div>
                                        <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                            @Html.DropDownListFor(m => m.SizeRangeMasterId, MMS.Web.ExtensionMethod.HtmlHelper.SizeRangeMaster(), new { @class = "select-style text-field " })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>
                        <hr style="border-bottom: 1px solid #3498db;" />
                        <div class="field-section" id="DispalySizeRange">
                            <div class="form-group">
                                <div class="col-md-8 col-lg-12 col-sm-12 col-xs-12" style="padding: 10px 0px;overflow:auto;">

                                    <div class="form-group" style="display: inline; margin-left: 2px;">
                                        <input id="Displaycheck" class="SizeRangeEv" type="checkbox" onclick="DisplaySizeRange()">
                                        <label for="Displaycheck" style="">Display Size Range</label>
                                    </div>
                                    <table id="sizeRangeTable">
                                        <tbody>
                                            <tr>
                                                <td style="background-color: #ddd; padding-bottom: 3px;  padding-left: 0;  padding-top: 1px;  width: 52px !important; float: left;">Size</td>
                                            </tr>
                                            <tr>
                                                <td style="background-color: #ddd; padding-bottom: 3px;padding-left: 0;  padding-top: 1px;  width: 52px !important; float: left;">IsCheck</td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </div>

                            </div>
                        </div>
                        <hr style="border-bottom: 1px solid #3498db;" />
                        <div class="field-section">
                            <div class="form-group">
                                <div class="col-md-8 col-lg-6 col-sm-12 col-xs-12" style="padding: 10px 0px;">
                                    <p style="display: inline;" class="section-title">If multiple Component for this material</p>
                                    <div class="form-group" style="display: inline; margin-left: 15px;">
                                        <input type="checkbox" checked="checked" id="component-check">
                                        <label for="component-check" style="">Components</label>
                                    </div>
                                </div>
                                <div class="col-md-4 col-sm-12 col-lg-6 col-xs-12">
                                    @{
                                        bool AddComponent = false; bool AddMaterial = false;
                                        foreach (var item in PermissionModel)
                                        {
                                            if (item.PermissionDesc == "AddComponent")
                                            {
                                                AddComponent = true;
                                            }
                                            if (item.PermissionDesc == "AddMaterial")
                                            {
                                                AddMaterial = true;
                                            }

                                        }
                                        if (AddComponent == true)
                                        {
                                            <button type="button" class="btn btn-default btn-style" value="AddComponent" id="add-Compenent">Add Component</button>
                                        }
                                        else
                                        {
                                            <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Add Component">
                                        }
                                        if (AddMaterial == true)
                                        {
                                            <button type="button" class="btn btn-default btn-style material_BOM" value="AddMaterial" id="add-Material">Add Material</button>
                                        }
                                        else
                                        {
                                            <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Add Material">
                                        }
                                    }
                                </div>
                            </div>
                        </div>
                        <hr style="border-bottom: 1px solid #3498db;" />
                        <div class="field-section">
                            <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12">

                                <div class="col-md-8 col-sm-8 col-lg-8 col-xs-12 no-padding padding-right-20 visbile-hide-show-sec">
                                    <p class="section-title">List the Components(Multiple Component)for this material</p>

                                    <div class="table-responsive table-td-padding parent-table-height">

                                        <table class="addfields table fixed-header" border="1" id="Addrowfields">
                                            <thead>
                                                <tr id="GetData">
                                                    <th>Si.No</th>
                                                    <th>Component</th>
                                                    <th>Length</th>
                                                    <th>Width</th>
                                                    <th>nos</th>
                                                    <th>Sample Norms</th>
                                                    <th>Wastage %</th>
                                                    <th>Wastage Qty</th>
                                                    <th>Total Norms</th>
                                                    <th>Delete</th>
                                                </tr>
                                            </thead>
                                            @if (Model != null && Model.bomGridList != null && Model.bomGridList.Count > 0)
                                            {
                                                foreach (BomGrid bom in Model.bomGridList)
                                                {
                                                    <tbody>
                                                        <tr id='appendvalue1' class='test'>
                                                            <td>

                                                                <input type="hidden" id="bomGridId" value="@bom.BomGridId">
                                                                <input type='text' id='Sno' value="@bom.Sno" disabled='disabled' />
                                                            </td>
                                                            <td>
                                                                <input type='text' id='Component' class="Component" value="@bom.Component" />
                                                            </td>
                                                            <td>
                                                                <input type='text' id='Length' class="Length" value="@bom.Length" onkeypress="isNumberKey(event)" />
                                                            </td>
                                                            <td>
                                                                <input type='text' id='Width' class="Width" value="@bom.Width" onkeypress="isNumberKey(event)" />
                                                            </td>
                                                            <td>
                                                                <input type='text' id='Nos' class="Nos" value="@bom.Nos" onkeypress="isNumberKey(event)" />
                                                            </td>
                                                            <td>
                                                                <input type='text' id='SampleNorms' class="SampleNorms" onkeypress="isNumberKey(event)" value="@bom.SampleNorms" />
                                                            </td>
                                                            <td>
                                                                <input type='text' id='WastagePercent' class="WastagePercent" onkeypress="isNumberKey(event)" value="@bom.WastagePercent" />
                                                            </td>
                                                            <td>
                                                                <input type='text' id='WastageQty' class="WastageQty" onkeypress="isNumberKey(event)" value="@bom.WastageQtyGrid" />
                                                            </td>
                                                            <td>
                                                                <input type='text' id='TotalNormsQty' class="TotalNormsQty" onkeypress="isNumberKey(event)" value="@bom.TotalNormsQty" />
                                                            </td>
                                                            <td>
                                                                <button type="button" class="remove-button" onkeypress="isNumberKey(event)" data-id='@bom.BomGridId'>Delete</button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                }
                                            }

                                        </table>
                                    </div>

                                </div>
                                <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12 no-padding">
                                    <p class="section-title">Set Norms with sample Norms</p>
                                    <div class="field-section">
                                        <div class="form-group">

                                            <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                                <label for="text" class="form-label">Our Norms/Sample Norms</label>
                                            </div>
                                            <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                                <div class="col-md-8 col-sm-8 col-lg-8 col-xs-12 pull-left no-padding">
                                                    @Html.DropDownListFor(m => m.OurNorms, new SelectList(
                                                                    new List<Object>
                                                                        {
                                                                        new { value = 0 , text = "Please Select"  },
                                                                        new { value = 1 , text = "Increase" },
                                                                        new { value = 2 , text = "Decrease" },
                                                                        new { value = 3 , text = "Same" }
                                                                        },
                                                                        "value",
                                                                        "text",
                                                                        0), new { @class = "select-style text-field ", style = "  width: 80px;" })

                                                    <div class="percent">%</div>
                                                </div>
                                                <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12  pull-right no-padding">
                                                    @Html.TextBoxFor(m => m.OurNormsPercent, new { @class = "form-control text-field ", @placeholder = "0.2558" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field-section">
                                        <div class="form-group">

                                            <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                                <label for="text" class="form-label">Purchase Norms</label>
                                            </div>
                                            <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                                <div class="col-md-8 col-sm-8 col-lg-8 col-xs-12 pull-left no-padding">
                                                    @Html.DropDownListFor(m => m.PurchaseNorms, new SelectList(
                                                                    new List<Object>
                                                                        {
                                                                        new { value = 0 , text = "Please Select"  },
                                                                        new { value = 1 , text = "Increase" },
                                                                        new { value = 2 , text = "Decrease" },
                                                                        new { value = 3 , text = "Same" }

                                                                        },
                                                                        "value",
                                                                        "text",
                                                                        0), new { @class = "select-style text-field EditAmndt", style = "  width: 80px;" })

                                                    <div class="percent">%</div>
                                                </div>
                                                <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12  pull-right no-padding">
                                                    @Html.TextBoxFor(m => m.PurchaseNormsPercent, new { @class = "form-control text-field ", @placeholder = "0.2558" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field-section">
                                        <div class="form-group">

                                            <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                                <label for="text" class="form-label">Issue Norms</label>
                                            </div>
                                            <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                                <div class="col-md-8 col-sm-8 col-lg-8 col-xs-12 pull-left no-padding">
                                                    @Html.DropDownListFor(m => m.IssueNorms, new SelectList(
                                                                    new List<Object>
                                                                        {
                                                                        new { value = 0 , text = "Please Select"  },
                                                                        new { value = 1 , text = "Increase" },
                                                                        new { value = 2 , text = "Decrease" },
                                                                        new { value = 3 , text = "Same" }

                                                                        },
                                                                        "value",
                                                                        "text",
                                                                        0), new { @class = "select-style text-field ", style = "  width: 80px;" })

                                                    <div class="percent">%</div>
                                                </div>
                                                <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12  pull-right no-padding">
                                                    @Html.TextBoxFor(m => m.IssueNormsPercent, new { @class = "form-control text-field ", @placeholder = "0.2558" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field-section">
                                        <div class="form-group">

                                            <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                                <label for="text" class="form-label">Costing Norms</label>
                                            </div>
                                            <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                                <div class="col-md-8 col-sm-8 col-lg-8 col-xs-12 pull-left no-padding">
                                                    @Html.DropDownListFor(m => m.CostingNorms, new SelectList(
                                                                    new List<Object>
                                                                        {
                                                                        new { value = 0 , text = "Please Select"  },
                                                                        new { value = 1 , text = "Increase" },
                                                                        new { value = 2 , text = "Decrease" },
                                                                        new { value = 3 , text = "Same" }

                                                                        },
                                                                        "value",
                                                                        "text",
                                                                        0), new { @class = "select-style text-field ", style = "  width: 80px;" })

                                                    <div class="percent">%</div>
                                                </div>
                                                <div class="col-md-4 col-sm-4 col-lg-4 col-xs-12  pull-right no-padding">
                                                    @Html.TextBoxFor(m => m.CostingNormsPercent, new { @class = "form-control text-field ", @placeholder = "0.2558" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                        <div class="" id="MaterialListGrid">
                            @{Html.RenderPartial("~/Views/Stock/BillOfMaterial/PartialView/_MaterialGrid.cshtml", Model);}

                        </div>
                        <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12" style="display:none" id="ParentDiv">
                            <p class="section-title">List of material and other items</p>
                            <div class="table-responsive table-td-padding parent-table-height" style="height:auto">
                                <table class="table" id="list-materials_">
                                    <thead>
                                        <tr>
                                            <td class="" style="display:none">BomNo</td>
                                            <td style="display:none">Description</td>
                                            <td style="display:none">BuyerMaster</td>
                                            <td style="display:none">BuyerModel</td>
                                            <td style="display:none">MeanSize</td>
                                            <td style="display:none">Date</td>
                                            <td style="display:none">ParentBomNo</td>
                                            <td style="display:none">LastBomNoEntered</td>
                                            <td style="display:none">LinkBomNo</td>
                                            <td class="" style="display:none">BOMMaterialID</td>
                                            <td class="" style="display:none">BomGridId</td>
                                            <td class="Delete" style="">Delete</td>
                                            <td class="Edit" style="">Edit</td>
                                            <td>MaterialCategoryMasterId</td>
                                            <td>MaterialName</td>
                                            <td>MaterialGroupMasterId</td>
                                            <td>ColorMasterId</td>
                                            <td>SubstanceMasterId</td>
                                            <td>SampleNorms</td>
                                            @*<td>Wastage %</td>
                                                <td>WastageQty</td>*@
                                            <td>WastageQtyUOM</td>
                                            <td>TotalNorms</td>
                                            @*<td>TotalNormsUOM</td>*@
                                            <td style="display:none">ComponentName</td>
                                            <td style="display:none">BuyerNorms</td>
                                            <td style="display:none">NoOfSets</td>
                                            <td style="display:none">UomMasterId</td>
                                            <td style="display:none">SupplierMasterId</td>
                                            <td style="display:none">SizeRangeMasterId</td>
                                            <td style="display:none">OurNorms</td>
                                            <td style="display:none">OurNormsPercent</td>
                                            <td style="display:none">PurchaseNorms</td>
                                            <td style="display:none">PurchaseNormsPercent</td>
                                            <td style="display:none">IssueNorms</td>
                                            <td style="display:none">IssueNormsPercent</td>
                                            <td style="display:none">CostingNorms</td>
                                            <td style="display:none">CostingNormsPercent</td>
                                            <td style="display:none">PreparedBy</td>
                                            <td style="display:none">VerifiedBy</td>
                                            <td style="display:none">CheckedBy</td>
                                            <td style="display:none">BOMMaterialID</td>
                                            <td class="" style="display:none">SizeScheduleMasterId</td>

                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>


                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="step2" class="tab-pane fade">
                <div class="container-fluid">



                    <div class="row">
                    </div>
                    <hr />
                    <div class="row">
                        <div class="field-section">
                            <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12">
                                <p class="section-title">List of Amended Material </p>

                                <div class="table-responsive table-td-padding parent-table-height">
                                    <table class="table" id="list-materials">
                                        <thead>
                                            <tr>
                                                <td style="display:none">BomNo</td>
                                                <td style="display:none">Description</td>
                                                <td style="display:none">BuyerMaster</td>
                                                <td style="display:none">BuyerModel</td>
                                                <td style="display:none">MeanSize</td>
                                                <td style="display:none">Date</td>
                                                <td style="display:none">ParentBomNo</td>
                                                <td style="display:none">LastBomNoEntered</td>
                                                <td style="display:none">LinkBomNo</td>
                                                <td>MaterialCategoryMasterId</td>
                                                <td>MaterialName</td>
                                                <td>MaterialGroupMasterId</td>
                                                <td>ColorMasterId</td>
                                                <td>SubstanceMasterId</td>
                                                <td>SampleNorms</td>
                                                @*<td>Wastage %</td>
                                                    <td>WastageQty</td>*@
                                                <td>WastageQtyUOM</td>
                                                <td>TotalNorms</td>
                                                @*<td>TotalNormsUOM</td>*@
                                                <td style="display:none">ComponentName</td>
                                                <td style="display:none">BuyerNorms</td>
                                                <td style="display:none">NoOfSets</td>
                                                <td style="display:none">UomMasterId</td>
                                                <td style="display:none">SupplierMasterId</td>
                                                <td style="display:none">SizeRangeMasterId</td>
                                                <td style="display:none">OurNorms</td>
                                                <td style="display:none">OurNormsPercent</td>
                                                <td style="display:none">PurchaseNorms</td>
                                                <td style="display:none">PurchaseNormsPercent</td>
                                                <td style="display:none">IssueNorms</td>
                                                <td style="display:none">IssueNormsPercent</td>
                                                <td style="display:none">CostingNorms</td>
                                                <td style="display:none">CostingNormsPercent</td>
                                                <td style="display:none">PreparedBy</td>
                                                <td style="display:none">VerifiedBy</td>
                                                <td style="display:none">CheckedBy</td>
                                                <td style="display:none">BOMMaterialID</td>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model != null && Model.bomMaterialGridList != null)
                                            {
                                                foreach (var item in Model.bomMaterialGridList)
                                                {
                                                    BuyerManager buyerManager = new BuyerManager();
                                                    BuyerMaster buyerMaster = new BuyerMaster();
                                                    buyerMaster = buyerManager.GetBuyerMasterId(item.BuyerMasterId);
                                                    <tr>
                                                        <td style="display:none">@item.BomNo</td>
                                                        <td style="display:none">@item.Description</td>
                                                        <td style="display:none">@buyerMaster.BuyerFullName</td>
                                                        <td style="display:none">@item.BuyerModel</td>
                                                        <td style="display:none">@item.MeanSize</td>
                                                        <td style="display:none">@item.Date</td>
                                                        <td style="display:none">@item.ParentBomNo</td>
                                                        <td style="display:none">@item.LastBomNoEntered</td>
                                                        <td style="display:none">@item.LinkBomNo</td>
                                                        <td>@item.MaterialCategoryMasterId</td>
                                                        <td>@item.MaterialMasterId</td>
                                                        <td>@item.MaterialGroupMasterId</td>
                                                        <td>@item.ColorMasterId</td>
                                                        <td>@item.SubstanceMasterId</td>
                                                        <td>@item.SampleNorms</td>
                                                        @*<td>@item.Wastage</td>
                                                            <td>@item.WastageQty</td>*@
                                                        <td>@item.WastageQtyUOM</td>
                                                        <td>@item.ComponentName</td>
                                                        @*<td>@item.TotalNormsUOM</td>*@
                                                        <td style="display:none">@item.BuyerNorms</td>
                                                        <td style="display:none">@item.NoOfSets</td>
                                                        <td style="display:none">@item.UomMasterId</td>
                                                        <td style="display:none">@item.SupplierMasterId</td>
                                                        <td style="display:none">@item.SizeRangeMasterId</td>
                                                        <td style="display:none">@item.OurNorms</td>
                                                        <td style="display:none">@item.OurNormsPercent</td>
                                                        <td style="display:none">@item.PurchaseNorms</td>
                                                        <td style="display:none">@item.PurchaseNormsPercent</td>
                                                        <td style="display:none">@item.IssueNorms</td>
                                                        <td style="display:none">@item.IssueNormsPercent</td>
                                                        <td style="display:none">@item.CostingNorms</td>
                                                        <td style="display:none">@item.CostingNormsPercent</td>
                                                        <td style="display:none">@item.PreparedBy</td>
                                                        <td style="display:none">@item.VerifiedBy</td>
                                                        <td style="display:none">@item.CheckedBy</td>
                                                        <td style="display:none">@item.BOMMaterialID</td>
                                                    </tr>
                                                }
                                            }
                                        </tbody>
                                    </table>
                                </div>


                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 col-lg-4 col-sm-4 col-xs-12">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                            <label for="text" class="form-label">Prepared By</label>
                                        </div>
                                        <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                            @Html.TextBoxFor(m => m.PreparedBy, new { @class = "form-control text-field ", placeholder = "enter text" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4 col-sm-4 col-xs-12">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                            <label for="text" class="form-label">Verified By</label>
                                        </div>
                                        <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                            @Html.TextBoxFor(m => m.VerifiedBy, new { @class = "form-control text-field ", placeholder = "enter text" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4 col-sm-4 col-xs-12">
                                <div class="field-section">
                                    <div class="form-group">

                                        <div class="col-md-5 col-sm-5 col-lg-5 col-xs-12">
                                            <label for="text" class="form-label">Checked By</label>
                                        </div>
                                        <div class="col-md-7 col-sm-7 col-lg-7 col-xs-12">
                                            @Html.TextBoxFor(m => m.CheckedBy, new { @class = "form-control text-field ", placeholder = "enter text" })
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="field-section">
                            <div class="form-group">

                                <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12">
                                    @{
                                        bool Instruct = false;

                                        foreach (var item in PermissionModel)
                                        {
                                            if (item.PermissionDesc == "Instruct")
                                            {
                                                Instruct = true;
                                            }

                                        }
                                        if (Instruct == true)
                                        {
                                            <button type="submit" class="btn btn-default btn-style">Instruct</button>
                                        }
                                        else
                                        {
                                            <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Instruct">
                                        }
                                    }
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
        </div>


        <div class="form-footer">
            <div class="row">
                <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 text-center">
                    <button type="submit" class="btn btn-default btn-style">Close</button>
                    @{
                        bool NotifyMsgMSS = false; bool Excel = false; bool SetUp = false; bool Print = false;
                        bool Preview = false; bool Delete = false; bool Save = false; bool Update = false;
                        foreach (var item in PermissionModel)
                        {
                            if (item.PermissionDesc == "Notify Msg / MSS")
                            {
                                NotifyMsgMSS = true;
                            }
                            if (item.PermissionDesc == "Excel")
                            {
                                Excel = true;
                            }
                            if (item.PermissionDesc == "SetUp")
                            {
                                SetUp = true;
                            }
                            if (item.PermissionDesc == "Preview")
                            {
                                Preview = true;
                            }
                            if (item.PermissionDesc == "Print")
                            {
                                Print = true;
                            }

                            if (item.PermissionDesc == "Delete")
                            {
                                Delete = true;
                            }
                            if (item.PermissionDesc == "Save")
                            {
                                Save = true;
                            }
                            if (item.PermissionDesc == "Update")
                            {
                                Update = true;
                            }

                        }
                        if (NotifyMsgMSS == true)
                        {
                            <button type="submit" class="btn btn-default btn-style">Notify Msg / MSS</button>
                        }
                        else
                        {
                            <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Notify Msg / MSS">
                        }
                        if (Excel == true)
                        {
                            <button type="submit" class="btn btn-default btn-style">Excel</button>
                        }
                        else
                        {
                            <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Excel">
                        }
                        if (SetUp == true)
                        {
                            <button type="submit" class="btn btn-default btn-style">SetUp</button>
                        }
                        else
                        {
                            <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="SetUp">
                        }
                        if (Preview == true)
                        {
                            <button type="submit" class="btn btn-default btn-style">Preview</button>
                        }
                        else
                        {
                            <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Preview">
                        }
                        if (Print == true)
                        {
                            <button type="submit" class="btn btn-default btn-style">Print</button>
                        }
                        else
                        {
                            <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Print">
                        }
                        if (Delete == true)
                        {
                            <button type="submit" class="btn btn-default btn-style">Delete</button>
                        }
                        else
                        {
                            <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Delete">
                        }
                        <button type="submit" class="btn btn-default btn-style">Clear</button>

                        if (Model.BomId == 0)
                        {
                            if (Save == true)
                            {
                                <input type="button" id="BtnSave" onclick="Save()" class="btn btn-default btn-style" style="cursor: pointer;" title="Save" value="Save">
                            }
                            else
                            {
                                <input type="button" id="BtnSave" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Save">
                            }
                        }
                        else
                        {
                            if (Update == true)
                            {
                                <input type="button" id="BtnSave" onclick="Save()" class="btn btn-default btn-style" style="cursor: pointer;" title="Update" value="Update">
                            }
                            else
                            {
                                <input type="button" onclick="alert('No Permission To access !')" style="cursor: pointer;" class="btn btn-default btn-style" value="Update">
                            }
                        }

                    }




                </div>
            </div>
        </div>
    </form>

</div>

<!-- Modal -->
<div class="modal fade" id="auto_search" role="dialog">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header sear_head">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Material Name List</h4>
            </div>
            <div class="modal-body sear_body">
                <ul class="mater_listers">
                    @foreach (var item in MMS.Web.ExtensionMethod.HtmlHelper.MaterialMasterName().Where(x => x.Value != ""))
                    {
                        <li id="@item.Value">@item.Text</li>
                    }
                </ul>
            </div>
            <div class="modal-footer">
                <button id="materialOpenId" type="button" class="btn btn-default" data-dismiss="modal">Ok</button>
            </div>
        </div>
    </div>
</div>

<div class="lefterr_icon">
    <div class="direction">  &lt;  </div>
</div>

                </body>
                </html>

@*<script src="~/Scripts/EasyAutocomplete-1.3.5/AutoComplete%20v1.10.2.js"></script>
    <script src="~/Scripts/EasyAutocomplete-1.3.5/AutoComplete%20v1.11.4.js"></script>
    <script src="~/Scripts/AutoCompleteCommon.js"></script>*@

<style>
    [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: fixed !important;
    }
</style>

<script>
    $(function () {
        $("#MaterialName").combobox();   
        $("#MaterialGroupMasterId").combobox();   
        $("#MaterialCategoryMasterId").combobox();
    });
    //$("#MaterialName").combobox();
    //$("#toggle").click(function () {
    //    $("#MaterialName").toggle();
    //});
    //$("#MaterialGroupMasterId").combobox();
    //$("#toggle").click(function () {
    //    $("#MaterialGroupMasterId").toggle();
    //});
    //$("#MaterialCategoryMasterId").combobox();
    //$("#toggle").click(function () {
    //    $("#MaterialCategoryMasterId").toggle();
    //});

    //$("#Date").datepicker({ dateFormat: "dd/mm/yy" });


    //$("#MaterialName").combobox();
    //$("#toggle").click(function () {
    //    $("#MaterialName").toggle();
    //});
    //$(".ui-autocomplete-input").change(function () {

    //    mateauto();
    //});

    function Cancel() {
        location.href = "../BillOfMaterial/BOMMaterialListGrid";
    }

    function isNumberKey(evt) {

        var charCode = (evt.which) ? evt.which : evt.keyCode;
        // console.log(evt.which);
        //console.log(evt.keyCode);
        //console.log(evt.which);
        if (charCode != 46 && charCode > 31
          && (charCode < 48 || charCode > 57))
            return false;

        return true;
    }

    $("#Conversion").blur(function () {
        var Total_buyerNormsPercentage = 0.00;
        var style = $('#Conversion').val();
        if (style != "") {
            var ConvertedNorms = parseFloat(style) * 10.76;
            ConvertedNorms = ConvertedNorms.toFixed(3);
            var ourNormsPercentage = $("#OurNormsPercent").val();
            var buyerNormsPercentage = ((parseFloat(ConvertedNorms) / 100) * parseFloat(ourNormsPercentage));
            $('#BuyerNorms').val(ConvertedNorms);
            if ($('#OurNorms option:selected').text().trim() == "Increase") {
                Total_buyerNormsPercentage = parseFloat(ConvertedNorms) + parseFloat(buyerNormsPercentage);
                $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
            }
            else if ($('#OurNorms option:selected').text().trim() == "Decrease") {
                Total_buyerNormsPercentage = parseFloat(ConvertedNorms) - parseFloat(buyerNormsPercentage);
                $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
            }
        }
    });
    $("#SampleNorms").blur(function () {
        var Total_buyerNormsPercentage = 0.00;
        var ConvertedNorms = $('#SampleNorms').val();
        if (ConvertedNorms != "") {
            var ourNormsPercentage = $("#OurNormsPercent").val();
            var buyerNormsPercentage = ((parseFloat(ConvertedNorms) / 100) * parseFloat(ourNormsPercentage));
            $('#BuyerNorms').val(buyerNormsPercentage.toFixed(3));
            if ($('#OurNorms option:selected').text().trim() == "Increase") {
                Total_buyerNormsPercentage = parseFloat(ConvertedNorms) + parseFloat(buyerNormsPercentage);
                $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
            }
            else if ($('#OurNorms option:selected').text().trim() == "Decrease") {
                Total_buyerNormsPercentage = parseFloat(ConvertedNorms) - parseFloat(buyerNormsPercentage);
                $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
            }
        }
    });
    $("#BuyerNorms").blur(function () {
        $('#TotalNorms').val('');
        var Total_buyerNormsPercentage = 0.00;
        var ConvertedNorms = $('#BuyerNorms').val();
        if (ConvertedNorms != "") {
            var ourNormsPercentage = $("#OurNormsPercent").val();
            var buyerNormsPercentage = ((parseFloat(ConvertedNorms) / 100) * parseFloat(ourNormsPercentage));
            // $('#BuyerNorms').val(buyerNormsPercentage.toFixed(3));
            if ($('#OurNorms option:selected').text().trim() == "Increase") {
                Total_buyerNormsPercentage = parseFloat(ConvertedNorms) + parseFloat(buyerNormsPercentage);
                $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
            }
            else if ($('#OurNorms option:selected').text().trim() == "Decrease") {
                Total_buyerNormsPercentage = parseFloat(ConvertedNorms) - parseFloat(buyerNormsPercentage);
                $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
            }
        }
    });
    $("#BomNo").blur(function () {
        var style = $('#BomNo').val();

        $.ajax({
            type: 'GET',
            url: ' @Url.Action("CheckBomNo", "BillOfMaterial")',
            data: { BomNo: style },
            success: function (data) {
                if (data.Message == "Already Existed") {
                    $('#Description').val(style);
                    $("#LinkBomNo").val("");
                    $("#add-Material").hide();
                    $("#BtnSave").hide();
                    alert("Already Existed please try another BOM.");
                    return false;
                }
                else {
                    if (data.productStyleMaster != null) {
                        $("#LinkBomNo").val(data.productStyleMaster.ProductOrBuyerStyleId);
                    }
                    else {
                        $("#LinkBomNo").val("");
                    }
                    $('#Description').val(style);
                    $("#add-Material").show();
                    $("#BtnSave").show();
                }

            },
        });

    });

    $("#CommnBOM1").change(function () {
        $.ajax({
            type: 'POST',
            url: ' @Url.Action("CommonBomNoDetail", "BillOfMaterial")',
            data: { CommnBOM: $('select#CommnBOM1 option:selected').text() },
            success: function (data) {
                $("#MaterialCategoryMasterId").val(data.MaterialCategoryMasterId);
                $("#MaterialGroupMasterId").val(data.MaterialGroupMasterId);
                $("#SubstanceMasterId").val(data.SubstanceMasterId);
                $("#MaterialName").val(data.MaterialName);
                $("#ColorMasterId").val(data.ColorMasterId);

                $("#SampleNorms").val(data.SampleNorms);
                $("#Wastage").val(data.Wastage);
                $("#WastageQty").val(data.WastageQty);
                $("#WastageQtyUOM").val(data.WastageQtyUOM);

                $("#TotalNorms").val(data.TotalNorms);
                $("#TotalNormsUOM").val(data.TotalNormsUOM);
            },
        });

    });

    $("#CommnBOM2").change(function () {
        $.ajax({
            type: 'POST',
            url: ' @Url.Action("CommonBomNoDetail", "BillOfMaterial")',
            data: { CommnBOM: $('select#CommnBOM2 option:selected').text() },
            success: function (data) {
                $("#MaterialCategoryMasterId").val(data.MaterialCategoryMasterId);
                $("#MaterialGroupMasterId").val(data.MaterialGroupMasterId);
                $("#SubstanceMasterId").val(data.SubstanceMasterId);
                $("#MaterialName").val(data.MaterialName);
                $("#ColorMasterId").val(data.ColorMasterId);

                $("#SampleNorms").val(data.SampleNorms);
                $("#Wastage").val(data.Wastage);
                $("#WastageQty").val(data.WastageQty);
                $("#WastageQtyUOM").val(data.WastageQtyUOM);

                $("#TotalNorms").val(data.TotalNorms);
                $("#TotalNormsUOM").val(data.TotalNormsUOM);
            },
        });

    });

    $("#CommnBOM3").change(function () {
        $.ajax({
            type: 'POST',
            url: ' @Url.Action("CommonBomNoDetail", "BillOfMaterial")',
            data: { CommnBOM: $('select#CommnBOM3 option:selected').text() },
            success: function (data) {
                $("#MaterialCategoryMasterId").val(data.MaterialCategoryMasterId);
                $("#MaterialGroupMasterId").val(data.MaterialGroupMasterId);
                $("#SubstanceMasterId").val(data.SubstanceMasterId);
                $("#MaterialName").val(data.MaterialName);
                $("#ColorMasterId").val(data.ColorMasterId);

                $("#SampleNorms").val(data.SampleNorms);
                $("#Wastage").val(data.Wastage);
                $("#WastageQty").val(data.WastageQty);
                $("#WastageQtyUOM").val(data.WastageQtyUOM);

                $("#TotalNorms").val(data.TotalNorms);
                $("#TotalNormsUOM").val(data.TotalNormsUOM);
            },
        });

    });

    $("#CommnBOM4").change(function () {
        $.ajax({
            type: 'POST',
            url: ' @Url.Action("CommonBomNoDetail", "BillOfMaterial")',
            data: { CommnBOM: $('select#CommnBOM4 option:selected').text() },
            success: function (data) {
                $("#MaterialCategoryMasterId").val(data.MaterialCategoryMasterId);
                $("#MaterialGroupMasterId").val(data.MaterialGroupMasterId);
                $("#SubstanceMasterId").val(data.SubstanceMasterId);
                $("#MaterialName").val(data.MaterialName);
                $("#ColorMasterId").val(data.ColorMasterId);

                $("#SampleNorms").val(data.SampleNorms);
                $("#Wastage").val(data.Wastage);
                $("#WastageQty").val(data.WastageQty);
                $("#WastageQtyUOM").val(data.WastageQtyUOM);

                $("#TotalNorms").val(data.TotalNorms);
                $("#TotalNormsUOM").val(data.TotalNormsUOM);
            },
        });

    });

    $("#CommnBOM5").change(function () {
        $.ajax({
            type: 'POST',
            url: ' @Url.Action("CommonBomNoDetail", "BillOfMaterial")',
            data: { CommnBOM: $('select#CommnBOM5 option:selected').text() },
            success: function (data) {
                $("#MaterialCategoryMasterId").val(data.MaterialCategoryMasterId);
                $("#MaterialGroupMasterId").val(data.MaterialGroupMasterId);
                $("#SubstanceMasterId").val(data.SubstanceMasterId);
                $("#MaterialName").val(data.MaterialName);
                $("#ColorMasterId").val(data.ColorMasterId);

                $("#SampleNorms").val(data.SampleNorms);
                $("#Wastage").val(data.Wastage);
                $("#WastageQty").val(data.WastageQty);
                $("#WastageQtyUOM").val(data.WastageQtyUOM);

                $("#TotalNorms").val(data.TotalNorms);
                $("#TotalNormsUOM").val(data.TotalNormsUOM);
            },
        });

    });
    $(function () {
        $("#MaterialCategoryMasterId").combobox({
            select: function() {
                var MaterialCategoryMasterId_ = $('#MaterialCategoryMasterId').val();
                $.ajax({
                    url: '/MaterialMaster/FillCateogoryid',
                    type: "GET",
                    dataType: "JSON",
                    data: { MaterialCategoryMasterId: MaterialCategoryMasterId_ },
                    success: function (cities) {
                        $("#MaterialGroupMasterId").html(""); // clear before appending new list
                        $.each(cities, function (i, city) {
                            $("#MaterialGroupMasterId").append(
                                $('<option></option>').val(city.MaterialGroupMasterId).html(city.GroupName));
                        });
                    }
                });
            }
        });
    });
    $(function () {
            $("#MaterialGroupMasterId").combobox({
                select: function() {
                    var MaterialGroupMasterId_ = $('#MaterialGroupMasterId').val();
                    $.ajax({
                        url: '/MaterialMaster/FillMaterialName',
                        type: "GET",
                        dataType: "JSON",
                        data: { MaterialGroupMasterId: MaterialGroupMasterId_ },
                        success: function (cities) {
                            if (cities.IsSubstance == true) {
                                $("#SubstanceMasterId").prop('disabled', false);
                            }
                            else {
                                $("#SubstanceMasterId").prop('disabled', true);
                                $('#SubstanceMasterId').val("");
                            }
                            if (cities.IsSize == false) {
                                $("#SizeRangeMasterId").prop('disabled', true);
                                $("#SizeScheduleMasterId").prop('disabled', true);
                                $("#SizeRangeMasterId").val("");
                                $("#SizeScheduleMasterId").val("");
                            }
                            else {
                                $("#SizeRangeMasterId").prop('disabled', false);
                                $("#SizeScheduleMasterId").prop('disabled', false);
                            }
                            if (cities.normDetails != null && cities.normDetails.BuyerNameid == parseInt($('#BuyerMasterId').val())) {
                                $('#TotalNorms').val("");
                                $("#OurNormsPercent").prop("disabled", true);
                                $("#CostingNormsPercent").prop("disabled", true);
                                $("#PurchaseNormsPercent").prop("disabled", true);
                                $("#IssueNormsPercent").prop("disabled", true);

                                $("#OurNorms").val(cities.normDetails.OurNorms);
                                $("#OurNormsPercent").val(cities.normDetails.NormsPercentage);

                                $("#PurchaseNorms").val(cities.normDetails.PurchaseNormsid);
                                $("#PurchaseNormsPercent").val(cities.normDetails.NormsPercentage1);

                                $("#IssueNorms").val(cities.normDetails.IssueNormsid);
                                $("#IssueNormsPercent").val(cities.normDetails.NormsPercentage2);

                                $("#CostingNorms").val(cities.normDetails.CostingNorms);
                                $("#CostingNormsPercent").val(cities.normDetails.NormsPercentage3);
                                if (cities.normDetails.BuyerOption == 1) {
                                    $("#Conversion").prop("disabled", false);
                                    $("#BuyerNorms").prop("disabled", false);
                                    $("#TotalNorms").prop("disabled", true);
                                    $("#SampleNorms").prop("disabled", true);
                                    var ourNormsPercentage = $("#OurNormsPercent").val();
                                    var BuyerNorms = $('#BuyerNorms').val();
                                    var buyerNormsPercentage = ((parseFloat(ConvertedNorms) / 100) * parseFloat(ourNormsPercentage));
                                    if ($('#OurNorms option:selected').text().trim() == "Increase") {
                                        Total_buyerNormsPercentage = parseFloat(ConvertedNorms) + parseFloat(buyerNormsPercentage);
                                        $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
                                    }
                                    else if ($('#OurNorms option:selected').text().trim() == "Decrease") {
                                        Total_buyerNormsPercentage = parseFloat(ConvertedNorms) - parseFloat(buyerNormsPercentage);
                                        $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
                                    }
                                    $('#TotalNorms').val("");
                                }
                                else if (cities.normDetails.BuyerOption == 2) {
                                    $('#TotalNorms').val("");
                                    $("#SampleNorms").prop("disabled", false);
                                    var ourNormsPercentage = $("#OurNormsPercent").val();
                                    var ConvertedNorms = $('#SampleNorms').val();
                                    if (ConvertedNorms != "") {
                                        var buyerNormsPercentage = ((parseFloat(ConvertedNorms) / 100) * parseFloat(ourNormsPercentage));
                                        $("#BuyerNorms").val(buyerNormsPercentage.toFixed(3));
                                        if ($('#OurNorms option:selected').text().trim() == "Increase") {
                                            Total_buyerNormsPercentage = parseFloat(ConvertedNorms) + parseFloat(buyerNormsPercentage);
                                            $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
                                        }
                                        else if ($('#OurNorms option:selected').text().trim() == "Decrease") {
                                            Total_buyerNormsPercentage = parseFloat(ConvertedNorms) - parseFloat(buyerNormsPercentage);
                                            $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
                                        }
                                    }
                                    $("#TotalNorms").prop("disabled", true);
                                    $("#BuyerNorms").prop("disabled", true);
                                }
                                else if (cities.normDetails.BuyerOption == 3) {

                                    $("#BuyerNorms").val("");
                                    $("#Conversion").prop("disabled", true);
                                    $("#SampleNorms").prop("disabled", true);
                                    $("#BuyerNorms").prop("disabled", true);
                                    $("#TotalNorms").prop("disabled", false);
                                }
                            }
                            else if (cities.normDetails != null && cities.normDetails.BuyerNameid != parseInt($('#BuyerMasterId').val())) {

                                $("#BuyerNorms").val("");
                                $("#SampleNorms").val("");
                                $("#Conversion").prop("disabled", true);
                                $("#SampleNorms").prop("disabled", true);
                                $("#TotalNorms").prop("disabled", false);
                                $("#BuyerNorms").prop("disabled", true);
                            }
                            else if (cities.normDetails == null) {

                                $("#BuyerNorms").val("");
                                $("#SampleNorms").val("");
                                $("#Conversion").prop("disabled", true);
                                $("#SampleNorms").prop("disabled", true);
                                $("#TotalNorms").prop("disabled", false);
                                $("#BuyerNorms").prop("disabled", true);
                            }
                            $("#MaterialName").html(""); // clear before appending new list
                            $.each(cities.Material, function (i, city) {
                                $("#MaterialName").append(
                                    $('<option></option>').val(city.MaterialMasterId).html(city.MaterialDescription));
                            });
                        }
                    });
                }
            });
        });
    $(function () {
            $("#MaterialName").combobox({
                select: function() {
                    var materialId = $('#MaterialName').val();
                    $.ajax({
                        url: '/MaterialMaster/FillMaterialNameBasedonColor',
                        type: "GET",
                        dataType: "JSON",
                        data: { MaterialNameID: materialId },
                        success: function (cities) {
                            $.each(cities, function (i, city) {
                                if($('#SubstanceMasterId').prop('disabled')==false)
                                {
                                    $('#SubstanceMasterId').val(city.SubstanceMasterId);
                                }
                                else{
                                    $('#SubstanceMasterId').prop('disabled',true);
                                }

                                $('#ColorMasterId').val(city.ColorMasterId);
                                if($("#MaterialCategoryMasterId").val()==""&&$("#MaterialGroupMasterId").val())
                                {
                                    $('#MaterialCategoryMasterId').val(city.MaterialCategoryMasterId);
                                    $('#MaterialGroupMasterId').val(city.MaterialGroupMasterId);
                                }

                                document.getElementById("ColorMasterId").disabled = true;
                                $('#UomMasterId').val(city.Uom);
                                if (city.SizeRangeMasterId != null && city.SizeRangeMasterId != 0 && $('#SizeRangeMasterId').prop('disabled') == false) {
                                    $('#SizeRangeMasterId').val(city.SizeRangeMasterId);
                                    //$('#SizeScheduleMasterId').val(city.SizeRangeMasterId);
                                }
                                else if($('#SizeRangeMasterId').prop('disabled') == false &&city.SizeRangeMasterId==null)
                                {
                                    $('#SizeRangeMasterId').val("");
                                    $("#SizeScheduleMasterId").val("");
                                    $("#SizeRangeMasterId").prop('disabled', false);
                                    $("#SizeScheduleMasterId").prop('disabled', false);
                                }
                                else if(city.SizeRangeMasterId==null||$('#SizeRangeMasterId').prop('disabled')==true) {
                                    $("#SizeRangeMasterId").prop('disabled', true);
                                    $("#SizeScheduleMasterId").prop('disabled', true);
                                    $("#SizeRangeMasterId").val("");
                                    $("#SizeScheduleMasterId").val("");
                                }
                                $('#TotalNormsUOM').val(city.UomUnit);
                                $('#WastageQtyUOM').val(city.Uom);
                            });

                        }
                    });
                }
            });
        });

    function Deletebtn(arg)
        {

            var id = $('.change_status').attr("id");
            if (confirm("Are you sure you want to delete this material?")) {
                $.ajax({
                    url: '/BillOfMaterial/BOMMaterialDelete',
                    type: "GET",
                    dataType: "JSON",
                    data: { BOMMaterialID: arg },
                    success: function (data) {
                        if (data.status.trim() == "Success") {
                            location.href = 'BillOfMaterialDetails?BOMID=' + data.BOMID;
                            alert("Deleted Successfully.");
                            return false;
                        }
                        else {
                            alert("Deleted failed.")
                            return false;
                        }
                    }
                });
            }
            else {
                return false;
            }

        }
        $(document).on('click', '#add-Material', function () {

            validation();
            if (validation() != false) {
                $('#BtnSave').hide();
                if (confirm("Are you sure you want to add material new this?")) {
                    $('#BOMMaterialID').val("");

                }
                else {
                    // return false;
                }
                var rowCount = $('#list-materials tr').length;
                var systemUserValue = '';
                var Sno = '';
                var compnt = '';
                var _length = '';
                var width = '';
                var nos = '';
                var samplenms = '';
                var wstg = '';
                var wstqty = '';
                var wsttotalNorms = '';
                $('#Addrowfields tbody tr').each(function () {
                    Sno = '';
                    compnt = '';
                    _length = '';
                    width = '';
                    nos = '';
                    samplenms = '';
                    wstg = '';
                    wstqty = '';
                    wsttotalNorms = '';
                    $(this).find("td").each(function () {
                        Sno = $('#Sno').val();
                        if (Sno != undefined && Sno.trim().length > 0) {
                            systemUserValue += Sno + ',';
                        }
                        compnt = $(this).find('#Component').val();
                        if (compnt != undefined && compnt.trim().length > 0) {
                            systemUserValue += compnt + ',';
                        }
                        _length = $(this).find('#length').val();
                        if (_length != undefined && _length.trim().length > 0) {
                            systemUserValue += _length + ',';
                        }
                        width = $(this).find('#width').val();
                        if (width != undefined && width.trim().length > 0) {
                            systemUserValue += width + ',';

                        }
                        nos = $(this).find('#Nos').val();
                        if (nos != undefined && nos.trim().length > 0) {
                            systemUserValue += nos + ',';
                        }

                        samplenms = $(this).find('#SampleNorms').val();
                        if (samplenms != undefined && samplenms.trim().length > 0) {
                            systemUserValue += samplenms + ',';
                        }
                        wstg = $(this).find('#WastagePercent').val();
                        if (wstg != undefined && wstg.trim().length > 0) {
                            systemUserValue += wstg + ',';
                        }
                        wstqty = $(this).find('#WastageQty').val();
                        if (wstqty != undefined && wstqty.trim().length > 0) {
                            systemUserValue += wstqty + ',';
                        }
                        wsttotalNorms = $(this).find('#TotalNormsQty').val();
                        if (wsttotalNorms != undefined && wsttotalNorms.trim().length > 0) {
                            systemUserValue += wsttotalNorms;
                        }

                    });
                    systemUserValue += '#';

                });
                var form = systemUserValue;
                $('#AddRowFields').val(form);
                $('#BOMMaterialID').val($('#BOMMaterialID').val())
                var CommnBOM = "";
                if ($('#CommnBOM1').val() != "") {
                    CommnBOM = $('#CommnBOM1').val();
                }
                if ($('#CommnBOM2').val() != "") {
                    CommnBOM += "," + $('#CommnBOM2').val();
                }
                if ($('#CommnBOM3').val() != "") {
                    CommnBOM += "," + $('#CommnBOM3').val();
                }
                if ($('#CommnBOM4').val() != "") {
                    CommnBOM += "," + $('#CommnBOM4').val(); S
                }
                if ($('#CommnBOM5').val() != "") {
                    CommnBOM += "," + $('#CommnBOM5').val();
                }
                //Display size range get implementation
                var CheckBoxIschecked_ = "";
                $('#sizeRangeTable tbody tr').find('.checked_checkbox').each(function () {
                    CheckBoxIschecked_ += $(this).is(':checked') + ",";
                });
                CheckBoxIschecked_ = CheckBoxIschecked_.slice(0, -1);
                var CheckBoxsize_ = "";
                $('#sizeRangeTable tbody tr').find('.SizeRangeRefValue').each(function () {
                    CheckBoxsize_ += $(this).text().trim() + ",";
                });
                CheckBoxsize_ = CheckBoxsize_.slice(0, -1);
                var rowCount = $('#list-materials tr').length - 1;
                if (rowCount == 0) {
                    if (validation()) {
                        var forms_ = $(".form-inline").serialize() + '&BOMMaterialID=' + $('#BOMMaterialID').val()+'&CheckBoxsize='+CheckBoxsize_+'&CheckBoxIschecked='+CheckBoxIschecked_;
                        if ($("#list-materials tbody tr").length == 0) {
                            $.ajax({
                                type: 'POST',
                                url: '/BillOfMaterial/BillOfMaterialDetails',
                                data: {
                                    forms: forms_,
                                    Grid: form,
                                    BOMMaterialID_: $('#BOMMaterialID').val(),
                                    BomGridlst: '@Model.BomGridlst',
                                    CheckBoxsize:CheckBoxsize_,
                                    CheckBoxIschecked:CheckBoxIschecked_
                                },
                                success: function (data) {
                                    if (data.AlertMessage == "Already Existed") {
                                        alert("Already  Existed this BOM.");
                                        return false;
                                    }
                                    else if (data.AlertMessage == "Saved Successfully") {
                                        alert("Saved Successfully.");
                                        if (data.BOM.BomId != 0) {
                                            $(this).addClass("curChangeableRow"),
                                           $(this).siblings().removeClass("curChangeableRow"),
                                            $("#materialCategory .custom-combobox input").val('');
                                            //  $("#MaterialGroupMasterId .custom-combobox input").val('');
                                            //   $("#MaterialName .custom-combobox input").val('');
                                            $("#Addrowfields > tbody").html("");
                                            $("#materialGroupID_ .custom-combobox input").val('');
                                            $("#SizeScheduleMasterId").val('');
                                            $("#SubstanceMasterId").val('');
                                            $("#masterialName_ .custom-combobox input").val('');
                                            $("#ColorMasterId").val('');
                                            $("#SampleNorms").val('');
                                            $("#Wastage").val('');
                                            $("#WastageQty").val('');
                                            $("#WastageQtyUOM").val('');
                                            $("#TotalNorms").val('');
                                            $("#TotalNormsUOM").val('');
                                            $("#ComponentName").val('');
                                            // $("#NoOfSets").val('');
                                            $("#SupplierMasterId").val('');
                                            $("#BuyerNorms").val('');
                                            $("#UomMasterId").val('');
                                            $("#SizeRangeMasterId").val('');
                                            $("#SizeScheduleMasterId").val('');
                                            $("#OurNorms").val('');
                                            $("#PurchaseNorms").val('');
                                            $("#IssueNorms").val('');
                                            $("#CostingNorms").val('');
                                            $("#OurNormsPercent").val('');
                                            $("#PurchaseNormsPercent").val('');
                                            $("#IssueNormsPercent").val('');
                                            $("#CostingNormsPercent").val('');
                                            $("#Addrowfields > tbody").html("");
                                            //console.log(data.Material);
                                            //console.log(data.Material.MaterialCategoryMasterId);
                                            var BOMMateriid = data.Material.BOMMaterialID;
                                            var BOMid = data.BOM.BomId;
                                            //'callChange(" + SnoVal + ")'
                                          
                                            $('#list-materials tbody').append("<tr id=" + rowCount + "><td style='display:none' class='BomNo'><span>" + data.Material.BOMMaterialID + "</span><input type='hidden' class='BomId' value='" + data.BOM.BomId + "'></td>" +
                                                                                                                     //"<td class='Description'><span>" + $('#Description').val() + "</span><input type='hidden' class='AddRowFields' value='" + $("#AddRowFields").val() + "'></td>" +
                                                                                                                     "<td style='display:none' class='Description' id='Description'>" + data.BOM.Description + "</td>" +
                                                                                                                     "<td style='display:none' class='BuyerMasterId' id='BuyerMasterId'>" + data.BOM.BuyerMasterId + "</td>" +
                                                                                                                     "<td style='display:none' class='BuyerModel' id='BuyerModel'>" + data.BOM.BuyerModel + "</td>" +
                                                                                                                     "<td style='display:none' class='MeanSize' id='MeanSize'>" + data.BOM.MeanSize + "</td>" +
                                                                                                                     "<td style='display:none' class='Date' id='Date'>" + data.BOM.Date + "</td>" +
                                                                                                                     "<td style='display:none' class='ParentBomNo' id='ParentBomNo'>" + data.BOM.ParentBomNo + "</td>" +
                                                                                                                     "<td style='display:none' class='LinkBomNo' id='LinkBomNo'>" + data.BOM.LinkBomNo + "</td>" +
                                                                                                                     "<td style='display:none' class='CommnBOM1' id='CommnBOM1'>" + data.BOM.CommnBOM1 + "</td>" +
                                                                                                                     "<td style='display:none' class='CommnBOM1' id='CommnBOM1'>" + data.Material.BOMMaterialID + "</td>" +
                                                                                                                      " <td title='Delete'  style='cursor:pointer;' class='Delete' id='Delete'><input type='button' value='Delete' style='cursor:pointer;' title='Delete' onclick='Deletebtn(" + data.Material.BOMMaterialID+")' class='change_status change_status_  Delete input Edit input' /></td>" +
                                                                                                                      " <td title='Edit'  style='cursor:pointer;' class='Edit' id='Edit'><input type='button' value='Edit' style='cursor:pointer;' title='Edit' onclick='RowClick(" + data.Material.BOMMaterialID + "," + data.BOM.BomId + ")' class='change_status change_status_ Delete input Edit input' /></td>" +
                                                                                                                    //" <td title='Delete' style='cursor:pointer;' class='Delete' id='Delete' onclick='Delete(" + item.IndentMaterialID + ")'><a href='data.Material.BOMMaterialID'>Delete</a></td>" +
                                                                                                                    // " <td title='Edit' style='cursor:pointer;' class='Edit' id='Edit'><a href='data.Material.BOMMaterialID'>Edit</a></td>" +
                                                                                                                     "<td class='MaterialCategoryMasterId' id='MaterialCategoryMasterId'>" + data.Material.MaterialCategoryMasterId + "</td>" +
                                                                                                                     "<td class='MaterialName' id='MaterialName'>" + data.Material.MaterialName + "</td>" +
                                                                                                                     "<td class='MaterialGroupMasterId' id='MaterialGroupMasterId'>" + data.Material.MaterialGroupMasterId + "</td>" +
                                                                                                                     "<td class='ColorMasterId' id='ColorMasterId'>" + data.Material.ColorMasterId + "</td>" +
                                                                                                                     "<td class='SubstanceMasterId' id='SubstanceMasterId'>" + data.Material.SubstanceMasterId + "</td>" +
                                                                                                                     "<td class='SampleNorms' id='SampleNorms'>" + data.Material.SampleNorms + "</td>" +
                                                                                                                     "<td class='Wastage' id='Wastage'>" + data.Material.Wastage + "</td>" +
                                                                                                                     "<td class='WastageQty' id='WastageQty'>" + data.Material.WastageQty + "</td>" +
                                                                                                                     "<td class='WastageQtyUOM' id='WastageQtyUOM'>" + data.Material.WastageQtyUOM + "</td>" +
                                                                                                                     "<td class='TotalNorms' id='TotalNorms'>" + data.Material.TotalNorms + "</td>" +
                                                                                                                     "<td class='TotalNormsUOM' id='TotalNormsUOM'>" + data.Material.TotalNormsUOM + "</td>" +
                                                                                                                     "<td style='display:none' class='SizeScheduleMasterId' id='SizeScheduleMasterId'>" + data.Material.SizeScheduleMasterId + "</td>" +
                                                                                                                     "<td style='display:none' class='ComponentName' id='ComponentName'>" + data.BOM.ComponentName + "</td>" +
                                                                                                                     "<td style='display:none' class='BuyerNorms' id='BuyerNorms'>" + data.BOM.BuyerNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='NoOfSets' id='NoOfSets'>" + data.BOM.NoOfSets + "</td>" +
                                                                                                                     "<td style='display:none' class='UomMasterId' id='UomMasterId'>" + data.BOM.UomMasterId + "</td>" +
                                                                                                                     "<td style='display:none' class='SupplierMasterId' id='SupplierMasterId'>" + data.Material.SupplierMasterID + "</td>" +
                                                                                                                     "<td style='display:none' class='SizeRangeMasterId' id='SizeRangeMasterId'>" + data.BOM.SizeRangeMasterId + "</td>" +
                                            // "<td style='display:none' class='SizeScheduleMasterId' id='SizeScheduleMasterId'>" + data.BOM.SizeScheduleMasterId + "</td>" +
                                                                                                                     "<td style='display:none' class='OurNorms' id='OurNorms'>" + data.BOM.OurNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='OurNormsPercent' id='OurNormsPercent'>" + data.BOM.OurNormsPercent + "</td>" +
                                                                                                                     "<td style='display:none' class='PurchaseNorms' id='PurchaseNorms'>" + data.BOM.PurchaseNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='PurchaseNormsPercent' id='PurchaseNormsPercent'>" + data.BOM.PurchaseNormsPercent + "</td>" +
                                                                                                                     "<td style='display:none' class='IssueNorms' id='IssueNorms'>" + data.BOM.IssueNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='IssueNormsPercent' id='IssueNormsPercent'>" + data.BOM.IssueNormsPercent + "</td>" +
                                                                                                                     "<td style='display:none' class='CostingNorms' id='CostingNorms'>" + data.BOM.CostingNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='CostingNormsPercent' id='CostingNormsPercent'>" + data.BOM.CostingNormsPercent + "</td>" +
                                                                                                                     "<td style='display:none' class='PreparedBy' id='PreparedBy'>" + data.BOM.PreparedBy + "</td>" +
                                                                                                                     "<td style='display:none' class='VerifiedBy' id='VerifiedBy'>" + data.BOM.VerifiedBy + "</td>" +
                                                                                                                     "<td style='display:none' class='CheckedBy' id='CheckedBy'>" + data.BOM.CheckedBy + "</td>"
                                                                                                                     + "<td style='display:none' class='AddRowFields'>" + $('#AddRowFields').val() + "</td></tr>");
                                            $('#BOMMaterialID').val(data.Material.BOMMaterialID)

                                        }
                                        return false;
                                    }
                                    else if (data.AlertMessage == "Updated Successfully") {
                                        if (data.BOM.BomId != 0) {
                                            $(this).addClass("curChangeableRow"),
                                           $(this).siblings().removeClass("curChangeableRow"),
                                            $("#materialCategory .custom-combobox input").val('');
                                            $("#Addrowfields > tbody").html("");
                                            $("#materialGroupID_ .custom-combobox input").val('');
                                            // $("#MaterialGroupMasterId .custom-combobox input").val('');
                                            // $("#MaterialName .custom-combobox input").val('');
                                            $("#SizeScheduleMasterId").val('');
                                            $("#SubstanceMasterId").val('');
                                            $("#masterialName_ .custom-combobox input").val('');
                                            $("#ColorMasterId").val('');
                                            $("#SampleNorms").val('');
                                            $("#Wastage").val('');
                                            $("#WastageQty").val('');
                                            $("#WastageQtyUOM").val('');
                                            $("#TotalNorms").val('');
                                            $("#TotalNormsUOM").val('');
                                            $("#ComponentName").val('');
                                            //$("#NoOfSets").val('');
                                            $("#SupplierMasterId").val('');
                                            $("#BuyerNorms").val('');
                                            $("#UomMasterId").val('');
                                            $("#SizeRangeMasterId").val('');
                                            $("#SizeScheduleMasterId").val('');
                                            $("#OurNorms").val('');
                                            $("#PurchaseNorms").val('');
                                            $("#IssueNorms").val('');
                                            $("#CostingNorms").val('');
                                            $("#OurNormsPercent").val('');
                                            $("#PurchaseNormsPercent").val('');
                                            $("#IssueNormsPercent").val('');
                                            $("#CostingNormsPercent").val('');
                                            $("#Addrowfields > tbody").html("");
                                            var BOMMateriid = data.Material.BOMMaterialID;
                                            var BOMid = data.BOM.BomId;                                           
                                            $('#list-materials tbody').append("<tr id=" + rowCount + "><td style='display:none' class='BomNo'><span>" + data.Material.BOMMaterialID + "</span><input type='hidden' class='BomId' value='" + data.BOM.BomId + "'></td>" +
                                                                                                                     //"<td class='Description'><span>" + $('#Description').val() + "</span><input type='hidden' class='AddRowFields' value='" + $("#AddRowFields").val() + "'></td>" +
                                                                                                                     "<td style='display:none' class='Description' id='Description'>" + data.BOM.Description + "</td>" +
                                                                                                                     "<td style='display:none' class='BuyerMasterId' id='BuyerMasterId'>" + data.BOM.BuyerMasterId + "</td>" +
                                                                                                                     "<td style='display:none' class='BuyerModel' id='BuyerModel'>" + data.BOM.BuyerModel + "</td>" +
                                                                                                                     "<td style='display:none' class='MeanSize' id='MeanSize'>" + data.BOM.MeanSize + "</td>" +
                                                                                                                     "<td style='display:none' class='Date' id='Date'>" + data.BOM.Date + "</td>" +
                                                                                                                     "<td style='display:none' class='ParentBomNo' id='ParentBomNo'>" + data.BOM.ParentBomNo + "</td>" +
                                                                                                                     "<td style='display:none' class='LinkBomNo' id='LinkBomNo'>" + data.BOM.LinkBomNo + "</td>" +
                                                                                                                     "<td style='display:none' class='CommnBOM1' id='CommnBOM1'>" + data.BOM.CommnBOM1 + "</td>" +
                                                                                                                     "<td style='display:none' class='CommnBOM1' id='CommnBOM1'>" + data.Material.BOMMaterialID + "</td>" +
                                                                                                                      " <td title='Delete'  style='cursor:pointer;' class='Delete' id='Delete'><input type='button' value='Delete' style='cursor:pointer;' title='Delete' onclick='Deletebtn(" + data.Material.BOMMaterialID+")' class='change_status change_status_ Delete input Edit input' /></td>" +
                                                                                                                      " <td title='Edit'  style='cursor:pointer;' class='Edit' id='Edit'><input type='button' value='Edit' style='cursor:pointer;' title='Edit' onclick='RowClick(" + data.Material.BOMMaterialID + "," + data.BOM.BomId + ")' class='change_status change_status_ Delete input Edit input' /></td>" +
                                                                                                                    //" <td title='Delete' style='cursor:pointer;' class='Delete' id='Delete' onclick='Delete(" + item.IndentMaterialID + ")'><a href='data.Material.BOMMaterialID'>Delete</a></td>" +
                                                                                                                     //" <td title='Delete' style='cursor:pointer;' class='Delete' id='Delete'><a href="+data.BOMMaterialID+" id="+data.BOMMaterialID+" class='change_status change_status_'>Delete</a></td>" +
                                                                                                                     //" <td title='Edit' style='cursor:pointer;' class='Edit' id='Edit'><a href='data.Material.BOMMaterialID'>Edit</a></td>" +
                                                                                                                     "<td class='MaterialCategoryMasterId' id='MaterialCategoryMasterId'>" + data.Material.MaterialCategoryMasterId + "</td>" +
                                                                                                                     "<td class='MaterialName' id='MaterialName'>" + data.Material.MaterialName + "</td>" +
                                                                                                                     "<td class='MaterialGroupMasterId' id='MaterialGroupMasterId'>" + data.Material.MaterialGroupMasterId + "</td>" +
                                                                                                                     "<td class='ColorMasterId' id='ColorMasterId'>" + data.Material.ColorMasterId + "</td>" +
                                                                                                                     "<td class='SubstanceMasterId' id='SubstanceMasterId'>" + data.Material.SubstanceMasterId + "</td>" +
                                                                                                                     "<td class='SampleNorms' id='SampleNorms'>" + data.Material.SampleNorms + "</td>" +
                                                                                                                     "<td class='Wastage' id='Wastage'>" + data.Material.Wastage + "</td>" +
                                                                                                                     "<td class='WastageQty' id='WastageQty'>" + data.Material.WastageQty + "</td>" +
                                                                                                                     "<td class='WastageQtyUOM' id='WastageQtyUOM'>" + data.Material.WastageQtyUOM + "</td>" +
                                                                                                                     "<td class='TotalNorms' id='TotalNorms'>" + data.Material.TotalNorms + "</td>" +
                                                                                                                     "<td class='TotalNormsUOM' id='TotalNormsUOM'>" + data.Material.TotalNormsUOM + "</td>" +
                                                                                                                     "<td style='display:none' class='SizeScheduleMasterId' id='SizeScheduleMasterId'>" + data.Material.SizeScheduleMasterId + "</td>" +
                                                                                                                     "<td style='display:none' class='ComponentName' id='ComponentName'>" + data.BOM.ComponentName + "</td>" +
                                                                                                                     "<td style='display:none' class='BuyerNorms' id='BuyerNorms'>" + data.BOM.BuyerNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='NoOfSets' id='NoOfSets'>" + data.BOM.NoOfSets + "</td>" +
                                                                                                                     "<td style='display:none' class='UomMasterId' id='UomMasterId'>" + data.BOM.UomMasterId + "</td>" +
                                                                                                                     "<td style='display:none' class='SupplierMasterId' id='SupplierMasterId'>" + data.Material.SupplierMasterID + "</td>" +
                                                                                                                     "<td style='display:none' class='SizeRangeMasterId' id='SizeRangeMasterId'>" + data.BOM.SizeRangeMasterId + "</td>" +
                                            // "<td style='display:none' class='SizeScheduleMasterId' id='SizeScheduleMasterId'>" + data.BOM.SizeScheduleMasterId + "</td>" +
                                                                                                                     "<td style='display:none' class='OurNorms' id='OurNorms'>" + data.BOM.OurNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='OurNormsPercent' id='OurNormsPercent'>" + data.BOM.OurNormsPercent + "</td>" +
                                                                                                                     "<td style='display:none' class='PurchaseNorms' id='PurchaseNorms'>" + data.BOM.PurchaseNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='PurchaseNormsPercent' id='PurchaseNormsPercent'>" + data.BOM.PurchaseNormsPercent + "</td>" +
                                                                                                                     "<td style='display:none' class='IssueNorms' id='IssueNorms'>" + data.BOM.IssueNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='IssueNormsPercent' id='IssueNormsPercent'>" + data.BOM.IssueNormsPercent + "</td>" +
                                                                                                                     "<td style='display:none' class='CostingNorms' id='CostingNorms'>" + data.BOM.CostingNorms + "</td>" +
                                                                                                                     "<td style='display:none' class='CostingNormsPercent' id='CostingNormsPercent'>" + data.BOM.CostingNormsPercent + "</td>" +
                                                                                                                     "<td style='display:none' class='PreparedBy' id='PreparedBy'>" + data.BOM.PreparedBy + "</td>" +
                                                                                                                     "<td style='display:none' class='VerifiedBy' id='VerifiedBy'>" + data.BOM.VerifiedBy + "</td>" +
                                                                                                                     "<td style='display:none' class='CheckedBy' id='CheckedBy'>" + data.BOM.CheckedBy + "</td>"
                                                                                                                     + "<td style='display:none' class='AddRowFields'>" + $('#AddRowFields').val() + "</td></tr>");
                                            $('#BOMMaterialID').val(data.Material.BOMMaterialID)

                                            //    $.each(data.Grid, function (i, item) {
                                            //        // console.log(item);
                                            //        $("#Addrowfields tbody").append("<tr class=''><td id='Sno' class='Sno' value=''>" + item.Sno + "</td>"
                                            //           + "<td class='width-141'><input type='text' id='Component' class='Component' value=" + item.Component + "/></td>"
                                            //           + "<td class='width-91'><input type='text' id='length' class='length' value=" + item.Length + " onkeypress=' return isNumberKey(event)' /></td>"
                                            //           + "<td class='width-91'><input type='text' id='width' class='width' value=" + item.Width + " onkeypress='return isNumberKey(event)' /></td>"
                                            //            + "<td class='width-91'><input type='text' id='Nos' class='Nos' value=" + item.Nos + " onkeypress='return isNumberKey(event)' /></td>"
                                            //            + "<td class='width-91'><input type='text' id='SampleNorms' class='SampleNorms' value=" + item.SampleNorms + " onkeypress='return isNumberKey(event)' /></td>"
                                            //            + "<td class='width-91'><input type='text' id='WastagePercent' class='WastagePercent' value=" + item.WastagePercent + " onkeypress='return isNumberKey(event)' /></td>"
                                            //             + "<td class='width-91'><input type='text' id='WastageQty' class='WastageQty' value=" + item.WastageQtyGrid + " onkeypress='return isNumberKey(event)' /></td>"
                                            //              + "<td class='width-91'><input type='text' id='TotalNormsQty' class='TotalNormsQty' value=" + item.TotalNormsQty + " onkeypress='return isNumberKey(event)' /></td> </tr>");
                                            //    });
                                            //}
                                            //$('#Addrowfields tbody').hide();
                                        }
                                        alert("Updated Successfully.");
                                        return false;
                                    }
                                }
                            });

                        }
                    }
                }
                else {
                    var forms_ = $(".form-inline").serialize() + '&BOMMaterialID=' + $('#BOMMaterialID').val() + '&CheckBoxsize='+CheckBoxsize_ +'&CheckBoxIschecked='+CheckBoxIschecked_;

                    $.ajax({
                        type: 'POST',
                        url: '/BillOfMaterial/BillOfMaterialDetails',
                        data: {
                            Grid: form,
                            forms: forms_,
                            BOMMaterialID_: $('#BOMMaterialID').val(),
                            BomId: $('#BomId').val(),
                            BomNo: $('#BomNo').val(),
                            Description: $('#Description').val(),
                            BuyerMasterId: $('#BuyerMasterId').val(),
                            BuyerModel: $("#BuyerModel").val(),
                            MeanSize: $("#MeanSize").val(),
                            Date: $("#Date").val(),
                            ParentBomNo: $("#ParentBomNo").val(),
                            LastBomNoEntered: $("#LastBomNoEntered").val(),
                            LinkBomNo: $("#LinkBomNo").val(),
                            Ammendment: $("#Ammendment").val(),
                            CommnBOM1: $('#CommnBOM1').val(),
                            CommnBOM2: $('#CommnBOM2').val(),
                            CommnBOM3: $('#CommnBOM3').val(),
                            CommnBOM4: $('#CommnBOM4').val(),
                            CommnBOM5: $('#CommnBOM5').val(),
                            PreparedBy: $("#PreparedBy").val(),
                            VerifiedBy: $("#VerifiedBy").val(),
                            CheckedBy: $("#CheckedBy").val(),
                            MaterialName: $("#MaterialName").val(),
                            MaterialCategoryMasterId: $("#MaterialCategoryMasterId").val(),
                            MaterialGroupMasterId: $("#MaterialGroupMasterId").val(),
                            ColorMasterId: $("#ColorMasterId").val(),
                            SubstanceMasterId: $("#SubstanceMasterId").val(),
                            SizeScheduleMasterId: $("#SizeScheduleMasterId").val(),
                            SampleNorms: $("#SampleNorms").val(),
                            Wastage: $("#Wastage").val(),
                            SupplierMasterId: $("#SupplierMasterId").val(),
                            UomMasterId: $("#UomMasterId").val(),
                            SizeRangeMasterId: $("#SizeRangeMasterId").val(),
                            SizeScheduleMasterId: $("#SizeScheduleMasterId").val(),
                            WastageQty: $("#WastageQty").val(),
                            WastageQtyUOM: $("#WastageQtyUOM").val(),
                            TotalNorms: $("#TotalNorms").val(),
                            TotalNormsUOM: $("#TotalNormsUOM").val(),
                            ComponentName: $("#ComponentName").val(),
                            NoOfSets: $("#NoOfSets").val(),
                            BuyerNorms: $("#BuyerNorms").val(),
                            OurNorms: $("#OurNorms").val(),
                            OurNormsPercent: $("#OurNormsPercent").val(),
                            PurchaseNorms: $("#PurchaseNorms").val(),
                            PurchaseNormsPercent: $("#PurchaseNormsPercent").val(),
                            IssueNorms: $("#IssueNorms").val(),
                            IssueNormsPercent: $("#IssueNormsPercent").val(),
                            CostingNorms: $("#CostingNorms").val(),
                            CostingNormsPercent: $("#CostingNormsPercent").val(),
                            BomGridlst: '@Model.BomGridlst',
                            CheckBoxsize:CheckBoxsize_,
                            CheckBoxIschecked:CheckBoxIschecked_

                        },
                        success: function (data) {

                            if (data.AlertMessage == "Already Existed") {
                                alert("Already  Existed this BOM.");
                                return false;
                            }
                            else if (data.AlertMessage == "Saved Successfully") {
                                if (data.BOM.BomId != 0) {
                                    $('#sizeRangeTable tbody tr').each(function(){
                                        $(this).find("td:not(:first)").remove();

                                    });
                                    $("#Displaycheck").prop('checked',false);
                                    $("#materialCategory .custom-combobox input").val('');
                                    $("#MaterialCategoryMasterId").val('');
                                    $("#MaterialGroupMasterId").val('');
                                    $("#MaterialName").val('');
                                    $("#Addrowfields > tbody").html("");
                                    $("#materialGroupID_ .custom-combobox input").val('');
                                    $("#SizeScheduleMasterId").val('');
                                    $("#SubstanceMasterId").val('');
                                    $("#masterialName_ .custom-combobox input").val('');
                                    $("#ColorMasterId").val('');
                                    $("#SampleNorms").val('');
                                    $("#Wastage").val('');
                                    $("#WastageQty").val('');
                                    $("#WastageQtyUOM").val('');
                                    $("#TotalNorms").val('');
                                    $("#TotalNormsUOM").val('');
                                    $("#ComponentName").val('');
                                    // $("#NoOfSets").val('');
                                    $("#SupplierMasterId").val('');
                                    $("#BuyerNorms").val('');
                                    $("#UomMasterId").val('');
                                    $("#SizeRangeMasterId").val('');
                                    $("#SizeScheduleMasterId").val('');
                                    $("#OurNorms").val('');
                                    $("#PurchaseNorms").val('');
                                    $("#IssueNorms").val('');
                                    $("#CostingNorms").val('');
                                    $("#OurNormsPercent").val('');
                                    $("#PurchaseNormsPercent").val('');
                                    $("#IssueNormsPercent").val('');
                                    $("#CostingNormsPercent").val('');
                                    $("#Addrowfields > tbody").html("");
                                   
                                    $('#list-materials tbody').append("<tr id=rowid_" + data.Material.BOMMaterialID + "><td style='display:none' class='BomNo'><span>" + data.Material.BOMMaterialID + "</span><input type='hidden' class='BomId' value='" + data.BOM.BomId + "'></td>" +
                                                                                                                      //"<td class='Description'><span>" + $('#Description').val() + "</span><input type='hidden' class='AddRowFields' value='" + $("#AddRowFields").val() + "'></td>" +
                                                                                                                      "<td style='display:none' class='Description' id='Description'>" + data.BOM.Description + "</td>" +
                                                                                                                      "<td style='display:none' class='BuyerMasterId' id='BuyerMasterId'>" + data.BOM.BuyerMasterId + "</td>" +
                                                                                                                      "<td style='display:none' class='BuyerModel' id='BuyerModel'>" + data.BOM.BuyerModel + "</td>" +
                                                                                                                      "<td style='display:none' class='MeanSize' id='MeanSize'>" + data.BOM.MeanSize + "</td>" +
                                                                                                                      "<td style='display:none' class='Date' id='Date'>" + data.BOM.Date + "</td>" +
                                                                                                                      "<td style='display:none' class='ParentBomNo' id='ParentBomNo'>" + data.BOM.ParentBomNo + "</td>" +
                                                                                                                      "<td style='display:none' class='LinkBomNo' id='LinkBomNo'>" + data.BOM.LinkBomNo + "</td>" +
                                                                                                                      "<td style='display:none' class='CommnBOM1' id='CommnBOM1'>" + data.BOM.CommnBOM1 + "</td>" +
                                                                                                                      "<td style='display:none' class='BOMMaterialID' id='BOMMaterialID'>" + data.Material.BOMMaterialID + "</td>" +
                                                                                                                      //" <td title='Delete' style='cursor:pointer;' class='Delete' id='Delete'><a href="+data.BOMMaterialID+" id="+data.BOMMaterialID+" class='change_status change_status_'>Delete</a></td>" +
                                                                                                                      " <td title='Delete'  style='cursor:pointer;' class='Delete' id='Delete'><input type='button' value='Delete' style='cursor:pointer;' title='Delete' onclick='Deletebtn(" + data.Material.BOMMaterialID+")' class='change_status change_status_ Delete input Edit input' /></td>" +
                                                                                                                      " <td title='Edit'  style='cursor:pointer;' class='Edit' id='Edit'><input type='button' value='Edit' style='cursor:pointer;' title='Edit' onclick='RowClick(" + data.Material.BOMMaterialID + "," + data.BOM.BomId + ")' class='change_status change_status_ Delete input Edit input' /></td>" +
                                                                                                                      "<td class='MaterialCategoryMasterId' id='MaterialCategoryMasterId'>" + data.Category + "</td>" +
                                                                                                                      "<td class='MaterialName' id='MaterialName'>" + data.Material_ + "</td>" +
                                                                                                                      "<td class='MaterialGroupMasterId' id='MaterialGroupMasterId'>" + data.Group + "</td>" +
                                                                                                                      "<td class='ColorMasterId' id='ColorMasterId'>" + data.Color + "</td>" +
                                                                                                                      "<td class='SubstanceMasterId' id='SubstanceMasterId'>" + data.Subtance + "</td>" +
                                                                                                                      "<td class='SampleNorms' id='SampleNorms'>" + data.Material.SampleNorms + "</td>" +
                                                                                                                      //"<td class='Wastage' id='Wastage'>" + data.Material.Wastage + "</td>" +
                                                                                                                      //"<td class='WastageQty' id='WastageQty'>" + data.Material.WastageQty + "</td>" +
                                                                                                                      "<td class='WastageQtyUOM' id='WastageQtyUOM'>" + data.WasteUOm + "</td>" +
                                                                                                                      "<td class='TotalNorms' id='TotalNorms'>" + data.Material.TotalNorms + "</td>" +
                                                                                                                      //"<td class='TotalNormsUOM' id='TotalNormsUOM'>" + data.TotalUOM + "</td>" +

                                                                                                                      "<td style='display:none' class='ComponentName' id='ComponentName'>" + data.BOM.ComponentName + "</td>" +
                                                                                                                      "<td style='display:none' class='BuyerNorms' id='BuyerNorms'>" + data.BOM.BuyerNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='NoOfSets' id='NoOfSets'>" + data.BOM.NoOfSets + "</td>" +
                                                                                                                      "<td style='display:none' class='UomMasterId' id='UomMasterId'>" + data.BOM.UomMasterId + "</td>" +
                                                                                                                      "<td style='display:none' class='SupplierMasterId' id='SupplierMasterId'>" + data.Material.SupplierMasterID + "</td>" +
                                                                                                                      "<td style='display:none' class='SizeRangeMasterId' id='SizeRangeMasterId'>" + data.BOM.SizeRangeMasterId + "</td>" +
                                                                                                                       "<td style='display:none' class='SizeScheduleMasterId' id='SizeScheduleMasterId'>" + data.Material.SizeScheduleMasterId + "</td>" +
                                                                                                                      "<td style='display:none' class='OurNorms' id='OurNorms'>" + data.BOM.OurNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='OurNormsPercent' id='OurNormsPercent'>" + data.BOM.OurNormsPercent + "</td>" +
                                                                                                                      "<td style='display:none' class='PurchaseNorms' id='PurchaseNorms'>" + data.BOM.PurchaseNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='PurchaseNormsPercent' id='PurchaseNormsPercent'>" + data.BOM.PurchaseNormsPercent + "</td>" +
                                                                                                                      "<td style='display:none' class='IssueNorms' id='IssueNorms'>" + data.BOM.IssueNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='IssueNormsPercent' id='IssueNormsPercent'>" + data.BOM.IssueNormsPercent + "</td>" +
                                                                                                                      "<td style='display:none' class='CostingNorms' id='CostingNorms'>" + data.BOM.CostingNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='CostingNormsPercent' id='CostingNormsPercent'>" + data.BOM.CostingNormsPercent + "</td>" +
                                                                                                                      "<td style='display:none' class='PreparedBy' id='PreparedBy'>" + data.BOM.PreparedBy + "</td>" +
                                     
                                     "<td style='display:none' class='VerifiedBy' id='VerifiedBy'>" + data.BOM.VerifiedBy + "</td>" +
                                                                                                                      "<td style='display:none' class='CheckedBy' id='CheckedBy'>" + data.BOM.CheckedBy + "</td>"
                                                                                                                      + "<td style='display:none' class='AddRowFields'>" + $('#AddRowFields').val() + "</td></tr>");
                                    $('#BOMMaterialID').val(data.Material.BOMMaterialID)
                                    //$("#Addrowfields > tbody").html("");
                                    //$.each(data.Grid, function (i, item) {
                                    //    $("#Addrowfields tbody").append("<tr class=''><td id='Sno' class='Sno' value=''>" + item.Sno + "</td>"
                                    //       + "<td class='width-141'><input type='text' id='Component' class='Component' value=" + item.Component + "/></td>"
                                    //       + "<td class='width-91'><input type='text' id='length' class='length' value=" + item.Length + " onkeypress=' return isNumberKey(event)' /></td>"
                                    //       + "<td class='width-91'><input type='text' id='width' class='width' value=" + item.Width + " onkeypress='return isNumberKey(event)' /></td>"
                                    //        + "<td class='width-91'><input type='text' id='Nos' class='Nos' value=" + item.Nos + " onkeypress='return isNumberKey(event)' /></td>"
                                    //        + "<td class='width-91'><input type='text' id='SampleNorms' class='SampleNorms' value=" + item.SampleNorms + " onkeypress='return isNumberKey(event)' /></td>"
                                    //        + "<td class='width-91'><input type='text' id='WastagePercent' class='WastagePercent' value=" + item.WastagePercent + " onkeypress='return isNumberKey(event)' /></td>"
                                    //         + "<td class='width-91'><input type='text' id='WastageQty' class='WastageQty' value=" + item.WastageQtyGrid + " onkeypress='return isNumberKey(event)' /></td>"
                                    //          + "<td class='width-91'><input type='text' id='TotalNormsQty' class='TotalNormsQty' value=" + item.TotalNormsQty + " onkeypress='return isNumberKey(event)' /></td> </tr>");
                                    //});
                                }
                                alert("Saved Successfully.");
                                return false;
                            }
                            else if (data.AlertMessage == "Updated Successfully") {
                                if (data.BOM.BomId != 0) {
                                    $('#sizeRangeTable tbody tr').each(function(){
                                        $(this).find("td:not(:first)").remove();
                                    });
                                    $("#Displaycheck").prop('checked',false);
                                    $("#materialCategory .custom-combobox input").val('');
                                    $("#MaterialCategoryMasterId").val('');
                                    $("#MaterialGroupMasterId").val('');
                                    $("#MaterialName").val('');
                                    $("#Addrowfields > tbody").html("");
                                    $("#materialGroupID_ .custom-combobox input").val('');
                                    $("#SizeScheduleMasterId").val('');
                                    $("#SubstanceMasterId").val('');
                                    $("#masterialName_ .custom-combobox input").val('');
                                    $("#ColorMasterId").val('');
                                    $("#SampleNorms").val('');
                                    $("#Wastage").val('');
                                    $("#WastageQty").val('');
                                    $("#WastageQtyUOM").val('');
                                    $("#TotalNorms").val('');
                                    $("#TotalNormsUOM").val('');
                                    $("#ComponentName").val('');
                                    // $("#NoOfSets").val('');
                                    $("#SupplierMasterId").val('');
                                    $("#BuyerNorms").val('');
                                    $("#UomMasterId").val('');
                                    $("#SizeRangeMasterId").val('');
                                    $("#SizeScheduleMasterId").val('');
                                    $("#OurNorms").val('');
                                    $("#PurchaseNorms").val('');
                                    $("#IssueNorms").val('');
                                    $("#CostingNorms").val('');
                                    $("#OurNormsPercent").val('');
                                    $("#PurchaseNormsPercent").val('');
                                    $("#IssueNormsPercent").val('');
                                    $("#CostingNormsPercent").val('');
                                    $("#Addrowfields > tbody").html("");
                                    $('#list-materials tbody').append("<tr id=rowid_" + data.Material.BOMMaterialID + "><td style='display:none' class='BomNo'><span>" + data.Material.BOMMaterialID + "</span><input type='hidden' class='BomId' value='" + data.BOM.BomId + "'></td>" +
                                                                                                                      //"<td class='Description'><span>" + $('#Description').val() + "</span><input type='hidden' class='AddRowFields' value='" + $("#AddRowFields").val() + "'></td>" +
                                                                                                                      "<td style='display:none' class='Description' id='Description'>" + data.BOM.Description + "</td>" +
                                                                                                                      "<td style='display:none' class='BuyerMasterId' id='BuyerMasterId'>" + data.BOM.BuyerMasterId + "</td>" +
                                                                                                                      "<td style='display:none' class='BuyerModel' id='BuyerModel'>" + data.BOM.BuyerModel + "</td>" +
                                                                                                                      "<td style='display:none' class='MeanSize' id='MeanSize'>" + data.BOM.MeanSize + "</td>" +
                                                                                                                      "<td style='display:none' class='Date' id='Date'>" + data.BOM.Date + "</td>" +
                                                                                                                      "<td style='display:none' class='ParentBomNo' id='ParentBomNo'>" + data.BOM.ParentBomNo + "</td>" +
                                                                                                                      "<td style='display:none' class='LinkBomNo' id='LinkBomNo'>" + data.BOM.LinkBomNo + "</td>" +
                                                                                                                      "<td style='display:none' class='CommnBOM1' id='CommnBOM1'>" + data.BOM.CommnBOM1 + "</td>" +
                                                                                                                      "<td style='display:none' class='BOMMaterialID' id='BOMMaterialID'>" + data.Material.BOMMaterialID + "</td>" +
                                                                                                                        " <td title='Delete'  style='cursor:pointer;' class='Delete' id='Delete'><input type='button' value='Delete' style='cursor:pointer;' title='Delete' onclick='Deletebtn(" + data.Material.BOMMaterialID+")' class='change_status change_status_ Delete input Edit input' /></td>" +
                                                                                                                      " <td title='Edit'  style='cursor:pointer;' class='Edit' id='Edit'><input type='button' value='Edit' style='cursor:pointer;' title='Edit' onclick='RowClick(" + data.Material.BOMMaterialID + "," + data.BOM.BomId + ")' class='change_status change_status_ Delete input Edit input' /></td>" +
                                                                                                                      //" <td title='Delete' style='cursor:pointer;' class='Delete' id='Delete'><a href="+data.BOMMaterialID+" id="+data.BOMMaterialID+" class='change_status change_status_'>Delete</a></td>" +
                                                                                                                      //" <td title='Edit'  style='cursor:pointer;' class='Edit' id='Edit'><a href='data.Material.BOMMaterialID'>Edit</a></td>" +
                                                                                                                      "<td class='MaterialCategoryMasterId' id='MaterialCategoryMasterId'>" + data.Category + "</td>" +
                                                                                                                      "<td class='MaterialName' id='MaterialName'>" + data.Material_ + "</td>" +
                                                                                                                      "<td class='MaterialGroupMasterId' id='MaterialGroupMasterId'>" + data.Group + "</td>" +
                                                                                                                      "<td class='ColorMasterId' id='ColorMasterId'>" + data.Color + "</td>" +
                                                                                                                      "<td class='SubstanceMasterId' id='SubstanceMasterId'>" + data.Subtance + "</td>" +
                                                                                                                      "<td class='SampleNorms' id='SampleNorms'>" + data.Material.SampleNorms + "</td>" +
                                                                                                                      //"<td class='Wastage' id='Wastage'>" + data.Material.Wastage + "</td>" +
                                                                                                                      //"<td class='WastageQty' id='WastageQty'>" + data.Material.WastageQty + "</td>" +
                                                                                                                      "<td class='WastageQtyUOM' id='WastageQtyUOM'>" + data.WasteUOm + "</td>" +
                                                                                                                      "<td class='TotalNorms' id='TotalNorms'>" + data.Material.TotalNorms + "</td>" +
                                                                                                                      //"<td class='TotalNormsUOM' id='TotalNormsUOM'>" + data.TotalUOM + "</td>" +

                                                                                                                      "<td style='display:none' class='ComponentName' id='ComponentName'>" + data.BOM.ComponentName + "</td>" +
                                                                                                                      "<td style='display:none' class='BuyerNorms' id='BuyerNorms'>" + data.BOM.BuyerNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='NoOfSets' id='NoOfSets'>" + data.BOM.NoOfSets + "</td>" +
                                                                                                                      "<td style='display:none' class='UomMasterId' id='UomMasterId'>" + data.BOM.UomMasterId + "</td>" +
                                                                                                                      "<td style='display:none' class='SupplierMasterId' id='SupplierMasterId'>" + data.Material.SupplierMasterID + "</td>" +
                                                                                                                      "<td style='display:none' class='SizeRangeMasterId' id='SizeRangeMasterId'>" + data.BOM.SizeRangeMasterId + "</td>" +
                                                                                                                       "<td style='display:none' class='SizeScheduleMasterId' id='SizeScheduleMasterId'>" + data.Material.SizeScheduleMasterId + "</td>" +
                                                                                                                      "<td style='display:none' class='OurNorms' id='OurNorms'>" + data.BOM.OurNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='OurNormsPercent' id='OurNormsPercent'>" + data.BOM.OurNormsPercent + "</td>" +
                                                                                                                      "<td style='display:none' class='PurchaseNorms' id='PurchaseNorms'>" + data.BOM.PurchaseNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='PurchaseNormsPercent' id='PurchaseNormsPercent'>" + data.BOM.PurchaseNormsPercent + "</td>" +
                                                                                                                      "<td style='display:none' class='IssueNorms' id='IssueNorms'>" + data.BOM.IssueNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='IssueNormsPercent' id='IssueNormsPercent'>" + data.BOM.IssueNormsPercent + "</td>" +
                                                                                                                      "<td style='display:none' class='CostingNorms' id='CostingNorms'>" + data.BOM.CostingNorms + "</td>" +
                                                                                                                      "<td style='display:none' class='CostingNormsPercent' id='CostingNormsPercent'>" + data.BOM.CostingNormsPercent + "</td>" +
                                                                                                                      "<td style='display:none' class='PreparedBy' id='PreparedBy'>" + data.BOM.PreparedBy + "</td>" +
                                                                                                                      "<td style='display:none' class='VerifiedBy' id='VerifiedBy'>" + data.BOM.VerifiedBy + "</td>" +
                                                                                                                      "<td style='display:none' class='CheckedBy' id='CheckedBy'>" + data.BOM.CheckedBy + "</td>"
                                                                                                                      + "<td style='display:none' class='AddRowFields'>" + $('#AddRowFields').val() + "</td></tr>");
                                    $('#BOMMaterialID').val(data.Material.BOMMaterialID)
                                    //$("#Addrowfields > tbody").html("");
                                    //$.each(data.Grid, function (i, item) {
                                    //    $("#Addrowfields tbody").append("<tr class=''><td id='Sno' class='Sno' value=''>" + item.Sno + "</td>"
                                    //       + "<td class='width-141'><input type='text' id='Component' class='Component' value=" + item.Component + "/></td>"
                                    //       + "<td class='width-91'><input type='text' id='length' class='length' value=" + item.Length + " onkeypress=' return isNumberKey(event)' /></td>"
                                    //       + "<td class='width-91'><input type='text' id='width' class='width' value=" + item.Width + " onkeypress='return isNumberKey(event)' /></td>"
                                    //        + "<td class='width-91'><input type='text' id='Nos' class='Nos' value=" + item.Nos + " onkeypress='return isNumberKey(event)' /></td>"
                                    //        + "<td class='width-91'><input type='text' id='SampleNorms' class='SampleNorms' value=" + item.SampleNorms + " onkeypress='return isNumberKey(event)' /></td>"
                                    //        + "<td class='width-91'><input type='text' id='WastagePercent' class='WastagePercent' value=" + item.WastagePercent + " onkeypress='return isNumberKey(event)' /></td>"
                                    //         + "<td class='width-91'><input type='text' id='WastageQty' class='WastageQty' value=" + item.WastageQtyGrid + " onkeypress='return isNumberKey(event)' /></td>"
                                    //          + "<td class='width-91'><input type='text' id='TotalNormsQty' class='TotalNormsQty' value=" + item.TotalNormsQty + " onkeypress='return isNumberKey(event)' /></td> </tr>");
                                    //});
                                }
                                alert("Updated Successfully");
                                return false;
                            }
                            if (data == "Material Existed") {
                                alert("Already  Existed this Material");
                                return false;
                            }
                        }
                    });
                }

            }
        });
        function BomSave() {
            var rowCount = $('#list-materials tr').length - 1;
            if (rowCount == 0) {

                if (validation()) {


                    var forms_ = $(".form-inline").serialize();

                    if ($("#list-materials tbody tr").length == 0) {

                        console.log(forms_);
                        console.log(form);
                        $.ajax({
                            type: 'POST',
                            url: '/BillOfMaterial/BillOfMaterialDetails',
                            data: { forms: forms_, Grid: $('.AddRowFields').text(), BomGridlst: '@Model.BomGridlst' },
                            success: function (data) {
                                if (data == true) {
                                    if ($("#BtnSave").val() == "Save") {
                                        alert('Saved Successfully.');
                                    }
                                    else {
                                        alert('Updated Successfully.');
                                    }
                                    location.href = "/BillOfMaterial/BOMMaterialListGrid";
                                    return false;
                                }
                                else {
                                    alert('Save process Failed.');
                                    location.href = "/BillOfMaterial/BOMMaterialListGrid";
                                    return false;
                                }
                            }
                        });

                    }
                }
            }
            else {

                var wholeJsonList = [];
                $('#list-materials tbody tr').each(function () {
                    $(this).addClass("curChangeableRow"),
                   $(this).siblings().removeClass("curChangeableRow"),
                  $('.curChangeableRow').hide(),
        wholeJsonList.push(
            {

                forms: forms_,
                Grid: $('.AddRowFields').text(),
                BomGridlst: '@Model.BomGridlst',
                BomNo: $(this).find('span').html(),
                Description: $(this).find('.Description').html(),
                BuyerMasterId: $(this).find('.BuyerMasterId').html(),
                BuyerModel: $(this).find('.BuyerModel').html(),
                MeanSize: $(this).find('.MeanSize').html(),
                Date: $(this).find('.Date').html(),
                ParentBomNo: $(this).find('.ParentBomNo').html(),
                LinkBomNo: $(this).find('.LinkBomNo').html(),
                CommnBOM1: $(this).find('.CommnBOM1').html(),
                MaterialCategoryMasterId: $(this).find('.MaterialCategoryMasterId').html(),
                MaterialName: $(this).find('.MaterialName').html(),
                MaterialGroupMasterId: $(this).find('.MaterialGroupMasterId').html(),
                ColorMasterId: $(this).find('.ColorMasterId').html(),
                SubstanceMasterId: $(this).find('.SubstanceMasterId').html(),
                SampleNorms: $(this).find('.SampleNorms').html(),
                Wastage: $(this).find('.Wastage').html(),
                WastageQty: $(this).find('.WastageQty').html(),
                WastageQtyUOM: $(this).find('.WastageQtyUOM').html(),
                TotalNorms: $(this).find('.TotalNorms').html(),
                TotalNormsUOM: $(this).find('.TotalNormsUOM').html(),
                ComponentName: $(this).find('.ComponentName').html(),
                BuyerNorms: $(this).find('.BuyerNorms').html(),
                NoOfSets: $(this).find('.NoOfSets').html(),
                UomMasterId: $(this).find('.UomMasterId').html(),
                SupplierMasterId: $(this).find('.SupplierMasterId').html(),
                SizeRangeMasterId: $(this).find('.SizeRangeMasterId').html(),
                SizeScheduleMasterId: $(this).find('.SizeScheduleMasterId').html(),
                OurNorms: $(this).find('.OurNorms').html(),
                OurNormsPercent: $(this).find('.OurNormsPercent').html(),
                PurchaseNorms: $(this).find('.PurchaseNorms').html(),
                PurchaseNormsPercent: $(this).find('.PurchaseNormsPercent').html(),
                IssueNorms: $(this).find('.IssueNorms').html(),
                IssueNormsPercent: $(this).find('.IssueNormsPercent').html(),
                CostingNorms: $(this).find('.CostingNorms').html(),
                CostingNormsPercent: $(this).find('.CostingNormsPercent').html(),
                PreparedBy: $(this).find('.PreparedBy').html(),
                VerifiedBy: $(this).find('.VerifiedBy').html(),
                CheckedBy: $(this).find('.CheckedBy').html(),
            });
                });

                var wholeJsonListLength = wholeJsonList.length;
                var i = 0;
                for (i = 0; i <= wholeJsonListLength - 1; i++) {
                    $.ajax({
                        type: 'POST',
                        url: '/BillOfMaterial/BillOfMaterialDetails',
                        data: wholeJsonList[i],
                        success: function (data) {
                            $('#BomId').val(data.BomId);
                            console.log(data.BomId);
                            return false;

                        }
                    });
                }
            }
        }

</script>
@*<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="/resources/demos/style.css">
    <link href="~/Scripts/EasyAutocomplete-1.3.5/comboStyles.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="~/Scripts/EasyAutocomplete-1.3.5/ComboBox.js"></script>*@
<script>
    function RowClick(arg, arg1) {
        var Removerow = "rowid_" + arg;
        $('#' + Removerow + '').remove()
        $('#add-Material').show();
        $('.material_BOM').show();
        $('#Removerow')
        $('#Addrowfields tbody tr').remove();
        $(this).addClass("curChangeableRow"),
        $(this).siblings().removeClass("curChangeableRow"),
        $('.curChangeableRow').hide(),
        $.ajax({
            type: 'POST',
            url: '/BillOfMaterial/GetBOMMaterilsList',
            data: { BOMMaterialID: arg, BOMID: arg1 },
            success: function (data) {
                if (data.BOM.BOMID != 0) {
                   
                    $('#BOMMaterialID').val(data.Material.BOMMaterialID);
                    $('#BOMMaterialID').val(arg);
                    $('#BomNo').val(data.BOM.BomNo);
                    $('#Description').val(data.BOM.Description);
                    $('#BuyerMasterId').val(data.BOM.BuyerMasterId);
                    $('#BuyerModel').val(data.BOM.BuyerModel);
                    $('#MeanSize').val(data.BOM.MeanSize);
                    //  $('#Date').val(data.BOM.Date.toString());
                    $('#ParentBomNo').val(data.BOM.ParentBomNo);
                    $('#LastBomNoEntered').val(data.BOM.LastBomNoEntered);
                    $('#LinkBomNo').val(data.BOM.LinkBomNo);
                    $('#Ammendment').val(data.BOM.Ammendment);
                    $('#CommonBomNo').val(data.BOM.CommonBomNo);
                    $('#CommnBOM1').val(data.BOM.CommnBOM1);
                    $('#CommnBOM2').val(data.BOM.CommnBOM2);
                    $('#CommnBOM3').val(data.BOM.CommnBOM3);
                    $('#CommnBOM4').val(data.BOM.CommnBOM4);
                    $('#CommnBOM5').val(data.BOM.CommnBOM5);
                    $('#PreparedBy').val(data.BOM.PreparedBy);
                    $('#VerifiedBy').val(data.BOM.VerifiedBy);
                    $('#CheckedBy').val(data.BOM.CheckedBy);
                    $('#ComponentName').val(data.BOM.ComponentName);
                    $('#BuyerNorms').val(data.BOM.BuyerNorms);
                    $('#NoOfSets').val(data.BOM.NoOfSets);
                    $('#UomMasterId').val(data.BOM.UomMasterId);
                    $('#SupplierMasterId').val(data.Material.SupplierMasterID);
                    $('#SizeRangeMasterId').val(data.BOM.SizeRangeMasterId);
                    $('#SizeScheduleMasterId').val(data.Material.SizeScheduleMasterId);
                    $('#OurNorms').val(data.BOM.OurNorms);
                    $('#OurNormsPercent').val(data.BOM.OurNormsPercent);
                    $('#PurchaseNorms').val(data.BOM.PurchaseNorms);
                    $('#PurchaseNormsPercent').val(data.BOM.PurchaseNormsPercent);
                    $('#IssueNorms').val(data.BOM.IssueNorms);
                    $('#IssueNormsPercent').val(data.BOM.IssueNormsPercent);
                    $('#CostingNorms').val(data.BOM.CostingNorms);
                    $('#CostingNormsPercent').val(data.BOM.CostingNormsPercent);
                    //$("#materialCategory .custom-combobox input").val('');
                    //$("#materialCategory .custom-combobox input").hide();
                    ////  $("#Addrowfields > tbody").html("");
                    //$("#materialGroupID_ .custom-combobox input").val('');
                    //$("#materialGroupID_ .custom-combobox input").hide();
                    //// $("#SizeScheduleMasterId").val('');
                    //// $("#SubstanceMasterId").val('');
                    //$("#masterialName_ .custom-combobox input").val('');
                    //$("#masterialName_ .custom-combobox input").hide();
                    $('#MaterialCategoryMasterId').val(data.Material.MaterialCategoryMasterId);
                    $("#MaterialCategoryMasterId").combobox('destroy') ;
                    $("#MaterialCategoryMasterId").combobox() ;
                    $('#MaterialGroupMasterId').val(data.Material.MaterialGroupMasterId);
                    $("#MaterialGroupMasterId").combobox('destroy');
                    $("#MaterialGroupMasterId").combobox();
                    $('#SubstanceMasterId').val(data.Material.SubstanceMasterId);
                    $('#MaterialName').val(data.Material.MaterialName);
                    $("#MaterialName").combobox('destroy') ;
                    $("#MaterialName").combobox(); 
                    $('#ColorMasterId').val(data.Material.ColorMasterId);
                    $('#SampleNorms').val(data.Material.SampleNorms);
                    $('#Wastage').val(data.Material.Wastage);
                    $('#WastageQty').val(data.Material.WastageQty);
                    $('#WastageQtyUOM').val(data.Material.WastageQtyUOM);
                    $('#TotalNorms').val(data.Material.TotalNorms);
                    $('#TotalNormsUOM').val(data.Material.TotalNormsUOM);
                    if (data.MaterialGroup.IsSubstance == true) {
                        $("#SubstanceMasterId").prop('disabled', false);
                    }
                    else {
                        $("#SubstanceMasterId").prop('disabled', true);
                    }
                    if (data.MaterialGroup.IsSize == false) {
                        $("#SizeRangeMasterId").prop('disabled', true);
                        $("#SizeScheduleMasterId").prop('disabled', true);
                        $("#SizeRangeMasterId").val("");
                        $("#SizeScheduleMasterId").val("");
                    }
                    else {
                        $("#SizeRangeMasterId").prop('disabled', false);
                        $("#SizeScheduleMasterId").prop('disabled', false);
                    }
                    if (data.Norms != null && data.Norms.BuyerNameid == parseInt($('#BuyerMasterId').val())) {
                        // $('#TotalNorms').val("");
                        $("#OurNormsPercent").prop("disabled", true);
                        $("#CostingNormsPercent").prop("disabled", true);
                        $("#PurchaseNormsPercent").prop("disabled", true);
                        $("#IssueNormsPercent").prop("disabled", true);

                        $("#OurNorms").val(data.Norms.OurNorms);
                        $("#OurNormsPercent").val(data.Norms.NormsPercentage);

                        $("#PurchaseNorms").val(data.Norms.PurchaseNormsid);
                        $("#PurchaseNormsPercent").val(data.Norms .NormsPercentage1);

                        $("#IssueNorms").val(data.Norms.IssueNormsid);
                        $("#IssueNormsPercent").val(data.Norms .NormsPercentage2);

                        $("#CostingNorms").val(data.Norms.CostingNorms);
                        $("#CostingNormsPercent").val(data.Norms.NormsPercentage3);
                        if (data.Norms.BuyerOption == 1) {
                          
                            $("#Conversion").prop("disabled", false);
                            $("#BuyerNorms").prop("disabled", false);
                            $("#TotalNorms").prop("disabled", true);
                            $("#SampleNorms").prop("disabled", true);
                            var ourNormsPercentage = $("#OurNormsPercent").val();
                            var BuyerNorms = $('#BuyerNorms').val();
                            var buyerNormsPercentage = ((parseFloat(BuyerNorms) / 100) * parseFloat(ourNormsPercentage));
                            if ($('#OurNorms option:selected').text().trim() == "Increase") {
                                Total_buyerNormsPercentage = parseFloat(BuyerNorms) + parseFloat(buyerNormsPercentage);
                                $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
                            }
                            else if ($('#OurNorms option:selected').text().trim() == "Decrease") {
                                Total_buyerNormsPercentage = parseFloat(BuyerNorms) - parseFloat(buyerNormsPercentage);
                                $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
                            }
                            // $('#TotalNorms').val("");
                        }
                        else if (data.Norms.BuyerOption == 2) {
                            //$('#TotalNorms').val("");
                            $("#SampleNorms").prop("disabled", false);
                            var ourNormsPercentage = $("#OurNormsPercent").val();
                            var ConvertedNorms = $('#SampleNorms').val();
                            if (ConvertedNorms != "") {
                                var buyerNormsPercentage = ((parseFloat(ConvertedNorms) / 100) * parseFloat(ourNormsPercentage));
                                $("#BuyerNorms").val(buyerNormsPercentage.toFixed(3));
                                if ($('#OurNorms option:selected').text().trim() == "Increase") {
                                    Total_buyerNormsPercentage = parseFloat(ConvertedNorms) + parseFloat(buyerNormsPercentage);
                                    $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
                                }
                                else if ($('#OurNorms option:selected').text().trim() == "Decrease") {
                                    Total_buyerNormsPercentage = parseFloat(ConvertedNorms) - parseFloat(buyerNormsPercentage);
                                    $('#TotalNorms').val(Total_buyerNormsPercentage.toFixed(3));
                                }
                            }
                            $("#TotalNorms").prop("disabled", true);
                            $("#BuyerNorms").prop("disabled", true);
                        }
                        else if (data.Norms.BuyerOption == 3) {

                            $("#BuyerNorms").val("");
                            $("#Conversion").prop("disabled", true);
                            $("#SampleNorms").prop("disabled", true);
                            $("#BuyerNorms").prop("disabled", true);
                            $("#TotalNorms").prop("disabled", false);
                        }
                    }
                    else if (data.Norms!= null && data.Norms.BuyerNameid != parseInt($('#BuyerMasterId').val())) {

                        $("#BuyerNorms").val("");
                        $("#SampleNorms").val("");
                        $("#Conversion").prop("disabled", true);
                        $("#SampleNorms").prop("disabled", true);
                        $("#TotalNorms").prop("disabled", false);
                        $("#BuyerNorms").prop("disabled", true);
                    }
                    else if (data.Norms == null) {

                        $("#BuyerNorms").val("");
                        $("#SampleNorms").val("");
                        $("#Conversion").prop("disabled", true);
                        $("#SampleNorms").prop("disabled", true);
                        $("#TotalNorms").prop("disabled", false);
                        $("#BuyerNorms").prop("disabled", true);
                    }
                    var count = 1;
                    if (data.MaterialGroup.IsSize == true) {
                        $('#Displaycheck').prop('checked',true);
                        for (var i = 0; i <= data.DisplaySize.length; i++) {

                            $('#sizeRangeTable tbody tr:first-child').append('<td  style="background-color: #ddd;padding-bottom: 3px;width: auto !important;padding:0 0px;" class="SizeRangeRefValue"> ' + data.DisplaySize[i].SizeRange + ' </td> ');
                            if(data.DisplaySize[i].SizeIsChecked==true)
                            {
                                $('#sizeRangeTable tbody tr:last').append("<td><input type='checkbox' checked='checked' name='size_chk' id='size_chk"+i+"' class='checked_checkbox'  style=''></input> <label for='size_chk"+i+"' style='' class='lbl-ch'></label></td>");
                            }
                            else{
                                $('#sizeRangeTable tbody tr:last').append("<td><input type='checkbox' name='size_chk' id='size_chk"+i+"' class='checked_checkbox'  style=''></input> <label for='size_chk"+i+"' style='' class='lbl-ch'></label></td>");
                            }
                            count++;
                        }
                    }
                    else{
                        $('#Displaycheck').prop('checked',false);
                        $('#sizeRangeTable tbody tr').each(function(){
                            $(this).find("td:not(:first)").remove();
                        });
                    }

                    $.each(data.Grid, function (i, item) {

                        $("#Addrowfields tbody").append("<tr class='Append'><td id='Sno' class='Sno' value=''>" + item.Sno + "</td>"
                        + "<td class='width-141'><input type='text' id='Component' class='Component' value=" + item.Component + "></td>"
                        + "<td class='width-91'><input type='text' id='length' class='length' value=" + item.Length + " onkeypress=' return isNumberKey(event)' /></td>"
                        + "<td class='width-91'><input type='text' id='width' class='width' value=" + item.Width + " onkeypress='return isNumberKey(event)' /></td>"
                        + "<td class='width-91'><input type='text' id='Nos' class='Nos' value=" + item.Nos + " onkeypress='return isNumberKey(event)' /></td>"
                        + "<td class='width-91'><input type='text' id='SampleNorms' class='SampleNorms' value=" + item.SampleNorms + " onkeypress='return isNumberKey(event)' /></td>"
                        + "<td class='width-91'><input type='text' id='WastagePercent' class='WastagePercent' value=" + item.WastagePercent + " onkeypress='return isNumberKey(event)' /></td>"
                        + "<td class='width-91'><input type='text' id='WastageQty' class='WastageQty' value=" + item.WastageQtyGrid + " onkeypress='return isNumberKey(event)' /></td>"
                        + "<td class='width-91'><input type='text' id='TotalNormsQty' class='TotalNormsQty' value=" + item.TotalNormsQty + " onkeypress='return isNumberKey(event)' /></td>"
                        + "<td><input type='button' value='Remove' class='removeSchedule btn btn-default btn-style' /></td></tr>");
                    });

                }
            }

        });
        //$("#MaterialName").combobox();
        //$("#toggle").click(function () {
        //    $("#MaterialName").toggle();
        //});
        //$("#MaterialGroupMasterId").combobox();
        //$("#toggle").click(function () {
        //    $("#MaterialGroupMasterId").toggle();
        //});
        //$("#MaterialCategoryMasterId").combobox();
        //$("#toggle").click(function () {
        //    $("#MaterialCategoryMasterId").toggle();
        //});
    }
    //$("#Category").combobox();
    //$("#UcGroup").combobox();
    //$("#Material").combobox();
    //$("#ShortUnitID").combobox();
    //$("#LongUnitValue").combobox();
    //$("#Category").combobox();
    //$("#UcGroup").combobox();
    //$("#Material").combobox();
    //$("#ShortUnitID").combobox();
    //$("#LongUnitValue").combobox();
    //$("#Category").combobox();
    //$("#UcGroup").combobox();
    //$("#Material").combobox();
    //$("#ShortUnitID").combobox();
    //$("#LongUnitValue").combobox();
    //$("#Category").combobox();
    //$("#UcGroup").combobox();
    //$("#Material").combobox();
    //$("#ShortUnitID").combobox();
    //$("#LongUnitValue").combobox();
</script>
